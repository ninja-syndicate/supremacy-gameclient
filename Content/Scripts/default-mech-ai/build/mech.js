/*! For license information please see mech.js.LICENSE.txt */
(()=>{var e={"./node_modules/behaviortree/lib/index.js":e=>{var t,s=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,u=(e,t)=>{for(var s in t||(t={}))c.call(t,s)&&d(e,s,t[s]);if(i)for(var s of i(t))l.call(t,s)&&d(e,s,t[s]);return e},T=(e,t)=>r(e,a(t)),_=(e,t)=>{var s={};for(var r in e)c.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&l.call(e,r)&&(s[r]=e[r]);return s},h=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})},p=(t="undefined"!=typeof WeakMap?new WeakMap:0,(e,r)=>t&&t.get(e)||(r=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of n(t))!c.call(e,r)&&s(e,r,{get:()=>t[r],enumerable:!(a=o(t,r))||a.enumerable});return e})(s({},"__esModule",{value:!0}),e),t&&t.set(e,r),r)),S={};h(S,{BehaviorTree:()=>R,BehaviorTreeImporter:()=>G,BranchNode:()=>H,Decorator:()=>U,FAILURE:()=>g,Introspector:()=>W,Node:()=>I,ObserverAborts:()=>O,Parallel:()=>q,ParallelComplete:()=>K,ParallelSelector:()=>X,RUNNING:()=>B,Random:()=>D,SUCCESS:()=>b,Selector:()=>Q,Sequence:()=>Z,Task:()=>L,decorators:()=>C,default:()=>Y,getRegistry:()=>k,registryLookUp:()=>M});var B=Symbol("running"),b=!0,g=!1;function v(e){return e===B||"object"==typeof e&&e.total===B}var f=()=>!1,m=()=>!0,P=()=>{},y=()=>{},I=class{constructor(e){this.nodeType="Node",this.ranStart=!1;var t=e,{run:s=f,start:r=m,end:o=P,abort:a=y}=t,n=_(t,["run","start","end","abort"]);this.blueprint=u({run:s,start:r,end:o,abort:a},n)}run(e,t={}){var s=t,{introspector:r,rerun:o=!1,registryLookUp:a=(e=>e)}=s,n=_(s,["introspector","rerun","registryLookUp"]);if(!o||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===g)return t}let i=this.blueprint.run(e,T(u({},n),{rerun:o,registryLookUp:a}));return i!==B&&this.blueprint.end(e),r&&r.push(this,i,e),i}abort(e,{registryLookUp:t=(e=>e),lastRun:s}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:s})}get name(){return this._name||this.blueprint.name}set name(e){this._name=e}},L=class extends I{constructor(){super(...arguments),this.nodeType="Task"}},A={};function k(){return A}function M(e){if("string"==typeof e){let t=A[e];if(!t)throw new Error(`No node with name ${e} registered.`);return t}return e}var R=class{constructor({tree:e,blackboard:t}){this.tree=e,this.blackboard=t,this.lastResult=void 0}step({introspector:e}={}){let t=this.lastResult&&"object"==typeof this.lastResult?this.lastResult:void 0,s=v(this.lastResult);e&&e.start(this),this.lastResult=M(this.tree).run(this.blackboard,{lastRun:t,introspector:e,rerun:s,registryLookUp:M}),e&&e.end()}static register(e,t){A[e]="function"==typeof t?new L({name:e,run:t}):t}static cleanRegistry(){A={}}},C={};h(C,{AlwaysFailDecorator:()=>F,AlwaysSucceedDecorator:()=>N,CooldownDecorator:()=>j,InvertDecorator:()=>x,LoopDecorator:()=>V});var w,O=((w=O||{})[w.None=0]="None",w[w.Self=1]="Self",w[w.LowerPriority=2]="LowerPriority",w[w.Both=3]="Both",w),E=e=>"observerAborts"in e,U=class extends I{constructor(e={config:{}}){var t=e,{config:s={}}=t;super(_(t,["config"])),this.nodeType="Decorator",this.observerAborts=0,this.setConfig(s)}condition(e){return b}decorate(e,t,s,r){return this.condition(t)||r&&1!==this.observerAborts&&3!==this.observerAborts?e(e,t,s):g}run(e,t={}){var s=t,{introspector:r,rerun:o,registryLookUp:a=(e=>e)}=s,n=_(s,["introspector","rerun","registryLookUp"]);if(!o||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===g)return t}let i=0,c=this.decorate((()=>(++i,a(this.blueprint.node).run(e,T(u({},n),{rerun:o,introspector:r,registryLookUp:a})))),e,this.config,o);return c!==B&&(this.blueprint.end(e),void 0!==(c===g&&this.blueprint.node)&&this.blueprint.node.blueprint.end(e)),r&&r.wrapLast(i,this,c,e),c}abort(e,{registryLookUp:t=(e=>e),lastRun:s}={}){super.abort(e,{registryLookUp:t,lastRun:s}),void 0!==this.blueprint.node&&this.blueprint.node.abort(e,{registryLookUp:t,lastRun:s})}setConfig(e){this.config=e}},F=class extends U{constructor(){super(...arguments),this.nodeType="AlwaysFailDecorator"}decorate(e){let t=e();return v(t)?t:g}},N=class extends U{constructor(){super(...arguments),this.nodeType="AlwaysSucceedDecorator"}decorate(e){let t=e();return v(t)?t:b}},j=class extends U{constructor(){super(...arguments),this.lock=!1,this.nodeType="CooldownDecorator"}setConfig({cooldown:e=5}){this.config={cooldown:e}}decorate(e){if(this.lock)return g;let t=e();return v(t)||(this.lock=!0,setTimeout((()=>{this.lock=!1}),1e3*this.config.cooldown)),t}},x=class extends U{constructor(){super(...arguments),this.nodeType="InvertDecorator"}decorate(e){let t=e();return v(t)?t:t===b?g:b}},V=class extends U{constructor(){super(...arguments),this.nodeType="LoopDecorator"}setConfig({loop:e=1/0}){this.config={loop:e}}decorate(e){let t=0,s=g;for(;t++<this.config.loop;)if(s=e(),s===g)return g;return s}},H=class extends I{constructor(e){super(e),this.OPT_OUT_CASE=b,this.START_CASE=b,this.nodeType="BranchNode",this.nodes=e.nodes||[],this.numNodes=this.nodes.length,this.observedDecorators=new Map}run(e={},{lastRun:t,introspector:s,rerun:r,registryLookUp:o=(e=>e)}={}){if(!r||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===g)return t}let a=this.START_CASE,n=[],i="object"==typeof t&&t.state||[],c=Math.max(i.findIndex((e=>v(e))),0),l=0;for(;l<this.numNodes;++l){let t=!1;if(r&&this.observedDecorators.has(l))t=!0;else if(l<c){n[l]=i[l];continue}let d=o(this.nodes[l]),u=!!E(d)&&d.condition(e);if(t&&E(d))if(this.observedDecorators.get(l)===u){if(r&&l<c){n[l]=i[l];continue}}else(2!==d.observerAborts||l!==c)&&(o(this.nodes[c]).abort(e,{registryLookUp:o,lastRun:i[c]}),r=!1,c=0);let T=d.run(e,{lastRun:i[l],introspector:s,rerun:r,registryLookUp:o});if(n[l]=T,E(d)&&d.observerAborts>0&&this.observedDecorators.set(l,u),T===B||"object"==typeof T){a=B;break}if(T===this.OPT_OUT_CASE){a=T;break}r=!1}let d=v(a);if(d||this.blueprint.end(e),s){let t=d?B:a;s.wrapLast(Math.min(l+1,this.numNodes),this,t,e)}return a===B?{total:a,state:n}:a}abort(e={},{lastRun:t,registryLookUp:s=(e=>e)}={}){super.abort(e,{registryLookUp:s,lastRun:t});let r="object"==typeof t&&t.state||[],o=Math.max(r.findIndex((e=>v(e))),0);s(this.nodes[o]).abort(e,{registryLookUp:s,lastRun:r[o]})}},D=class extends H{constructor(){super(...arguments),this.nodeType="Random"}run(e={},{lastRun:t,introspector:s,rerun:r,registryLookUp:o=(e=>e)}={}){let a=0;r?a=t.state.findIndex((e=>v(e))):(this.blueprint.start(e),a=Math.floor(Math.random()*this.numNodes));let n=o(this.nodes[a]).run(e,{lastRun:t,introspector:s,rerun:r,registryLookUp:o}),i=v(n);if(i||this.blueprint.end(e),s){let t=i?B:n;s.wrapLast(1,this,t,e)}if(i){let e={total:B,state:new Array(this.numNodes).fill(void 0)};return e.state[a]=n,e}return n}},Q=class extends H{constructor(){super(...arguments),this.nodeType="Selector",this.START_CASE=g,this.OPT_OUT_CASE=b}},Z=class extends H{constructor(){super(...arguments),this.nodeType="Sequence",this.START_CASE=b,this.OPT_OUT_CASE=g}},G=class{constructor(){this.types={task:L,decorator:U,selector:Q,sequence:Z,random:D,invert:x,fail:F,succeed:N,cooldown:j,loop:V}}defineType(e,t){this.types[e]=t}parse(e){let t=e,{type:s,name:r}=t,o=_(t,["type","name"]),a=this.types[s];if(!a){let e=M(s);if(e)return e.name=r,e;throw new Error(`Don't know how to handle type ${s}. Please register this first.`)}return new a({name:r,node:e.node?this.parse(e.node):null,nodes:e.nodes?e.nodes.map((e=>this.parse(e))):null,config:o})}},W=class{constructor(){this.currentResult=[],this.results=[]}start(e){this.tree=e,this.currentResult=[]}end(){let e=this.currentResult.pop();e&&this.results.push(e),delete this.tree,this.currentResult=[]}push(e,t,s){this.currentResult.push(this._toResult(e,t,s))}wrapLast(e,t,s,r){let o=this.currentResult.splice(this.currentResult.length-e,e);this.currentResult.push(T(u({},this._toResult(t,s,r)),{children:o}))}_toResult(e,t,s){return T(u({},e.name?{name:e.name}:{}),{result:t})}reset(){this.results=[]}get lastResult(){return 0===this.results.length?null:this.results[this.results.length-1]}},q=class extends H{constructor(e){super(e),this.nodeType="Parallel",this.nodes=e.nodes||[],this.numNodes=this.nodes.length}run(e={},{lastRun:t,introspector:s,rerun:r,registryLookUp:o=(e=>e)}={}){if(!r||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===g)return t}let a=[];for(let n=0;n<this.numNodes;++n){let i=t&&t.state[n];if(i&&!v(i)){a[n]=i;continue}let c=o(this.nodes[n]).run(e,{lastRun:i,introspector:s,rerun:r,registryLookUp:o});a[n]=c}let n=this.calcResult(a);if(v(n)||this.blueprint.end(e),s){let t=a.find((e=>v(e)))?B:n;s.wrapLast(this.numNodes,this,t,e)}return n}calcResult(e){return e.includes(g)?g:e.find((e=>v(e)))?{total:B,state:e}:b}abort(e,{registryLookUp:t=(e=>e),lastRun:s}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:s});for(let r of this.nodes)r.abort(e,{registryLookUp:t,lastRun:s})}},K=class extends q{constructor(){super(...arguments),this.nodeType="ParallelComplete"}calcResult(e){return e.includes(g)?g:e.includes(b)?b:{total:B,state:e}}},X=class extends q{constructor(){super(...arguments),this.nodeType="ParallelSelector"}calcResult(e){return e.includes(g)?g:e.find((e=>v(e)))?{total:B,state:e}:b}},Y=R;e.exports=p(S)},"./src/Sound.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sound=void 0,t.Sound=class{constructor(e,t){this.time=t,this.soundDetail=e}getVectorValue(){return this.soundDetail.location}}},"./src/aiconfig.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENABLE_DEBUGGING=t.CURRENT_AI_CONFIG=void 0,t.CURRENT_AI_CONFIG={closeCombatEnterRange:2250,closeCombatExitRange:3500,lowShieldThreshold:.45,veryLowTotalHealthThreshold:.45,damageStimulusTimeout:10,predictionTimeout:10,tauntNoiseStimulusTimeout:30,weaponNoiseStimulusTimeout:5},t.ENABLE_DEBUGGING=!1},"./src/branches/ParallelBackground.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParallelBackground=void 0;const r=s("./node_modules/behaviortree/lib/index.js");class o extends r.Parallel{constructor(){super(...arguments),this.nodeType="ParallelBackground"}run(e={},{lastRun:t,introspector:s,rerun:o,registryLookUp:c=(e=>e)}={}){const l=[];let d=!1;if(this.ranStart)for(let s=1;s<this.numNodes;++s){let o=t&&t.state[s];if(o&&i(o)){const t=c(this.nodes[s]).blueprint.start(e);if(t===r.FAILURE){l[s]=t,d=!0;break}}}if(!o||!this.ranStart){this.ranStart=!0;const t=this.blueprint.start(e);if(t===r.FAILURE)return t}if(!d)for(let r=0;r<this.numNodes;++r){let d=t&&t.state[r];if(d&&!a(d)){if(l[r]=d,0===r)break;if(n(d))break}const u=c(this.nodes[r]),T=!i(d)&&o,_=!i(d)&&d,h=u.run(e,{lastRun:_,introspector:s,rerun:T,registryLookUp:c});if(l[r]=h,0===r&&n(h))break}const u=this.calcResult(l);if((n(u)||i(l[0]))&&this.blueprint.end(e),s){const t=l.find((e=>a(e)))?r.RUNNING:u;s.wrapLast(this.numNodes,this,t,e)}return i(l[0])?r.SUCCESS:u}abort(e,{registryLookUp:t=(e=>e),lastRun:s}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:s});for(const r of this.nodes)r.abort(e,{registryLookUp:t,lastRun:s})}calcResult(e){return e.includes(r.FAILURE)?r.FAILURE:{total:r.RUNNING,state:e}}}function a(e){return e===r.RUNNING||"object"==typeof e&&e.total===r.RUNNING}function n(e){return e===r.FAILURE||"object"==typeof e&&e.total===r.FAILURE}function i(e){return e===r.SUCCESS||"object"==typeof e&&e.total===r.SUCCESS}t.ParallelBackground=o},"./src/decorators/CanActivateAction.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanActivateAction=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");class a extends r.Decorator{constructor(){super(...arguments),this.nodeType="CanActivateActionDecorator"}setConfig(e){this.config=e,this.observerAborts=e.observerAborts}condition(e){return!!o.AI.CanActivateAction(this.config.action)===this.config.isMatch}}t.CanActivateAction=(e,t,s=!0,o=r.ObserverAborts.None)=>new a({node:e,config:{action:t,isMatch:s,observerAborts:o}})},"./src/decorators/IsSet.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsSet=void 0;const r=s("./node_modules/behaviortree/lib/index.js");class o extends r.Decorator{constructor(){super(...arguments),this.nodeType="IsSetDecorator"}setConfig(e){this.config=e,this.observerAborts=e.observerAborts}condition(e){return!!e[this.config.blackboardKey]===this.config.isSet}}t.IsSet=(e,t,s=!0,a=r.ObserverAborts.None)=>new o({node:e,config:{blackboardKey:t,isSet:s,observerAborts:a}})},"./src/decorators/Predicate.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate=t.PredicateDecorator=void 0;const r=s("./node_modules/behaviortree/lib/index.js");class o extends r.Decorator{constructor(){super(...arguments),this.nodeType="PredicateDecorator"}setConfig(e){this.config=e,this.observerAborts=e.observerAborts}condition(e){return!!this.config.predicate(e)===this.config.isMatch}}t.PredicateDecorator=o,t.Predicate=(e,t,s=!0,a=r.ObserverAborts.None)=>new o({node:e,config:{predicate:t,isMatch:s,observerAborts:a}})},"./src/helper.ts":(e,t)=>{"use strict";function s(e,t){const{X:s,Y:r,Z:o}=e,{X:a,Y:n,Z:i}=t,c={X:a-s,Y:n-r,Z:i-o};return Math.sqrt(Math.pow(c.X,2)+Math.pow(c.Y,2)+Math.pow(c.Z,2))}function r(e,t){Math.abs(t);const s=e/t;return e-t*Math.trunc(s)}Object.defineProperty(t,"__esModule",{value:!0}),t.getForwardVector=t.fmod=t.rotateZ=t.multiply=t.add=t.distanceToVec=t.distanceTo=t.isDead=void 0,t.isDead=function(e){return e.health<=0},t.distanceTo=function(e,t){return s(e.location,t.location)},t.distanceToVec=s,t.add=function(e,t){const{X:s,Y:r,Z:o}=e,{X:a,Y:n,Z:i}=t;return{X:s+a,Y:r+n,Z:o+i}},t.multiply=function(e,t){const{X:s,Y:r,Z:o}=e;return{X:s*t,Y:r*t,Z:o*t}},t.rotateZ=function(e,t){const s=t*(Math.PI/180),{X:r,Y:o,Z:a}=e;return{X:r*Math.cos(s)-o*Math.sin(s),Y:r*Math.sin(s)+o*Math.cos(s),Z:a}},t.fmod=r,t.getForwardVector=function(e){const{X:t,Y:s,Z:o}=e,a=e=>e*(Math.PI/180),n=r(s,360),i=r(o,360),c=Math.sin(a(n)),l=Math.cos(a(n)),d=Math.sin(a(i));return{X:l*Math.cos(a(i)),Y:l*d,Z:c}}},"./src/index.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AI=void 0;const r=s("./src/mech.ts");t.AI=Context.GetOwner(),Context.OnMessage=(e,t)=>{try{switch(e){case"onTick":(0,r.onTick)(JSON.parse(t));break;case"onBegin":(0,r.onBegin)(JSON.parse(t))}}catch(e){console.log(e)}}},"./src/mech.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearBlackboardTarget=t.onTick=t.onBegin=t.tree=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/helper.ts"),a=s("./src/index.ts"),n=s("./src/trees/BT_Root.ts"),i=s("./src/utils.ts"),c=s("./src/Sound.ts"),l=s("./src/utility/evaluator.ts"),d=s("./src/utility/test.ts"),u=s("./src/utility/helper.ts");function T(e){const s=t.tree.blackboard,r=[e=>1-(e.health+e.shield)/(e.healthMax+e.shieldMax),e=>1-Math.min(1,(0,o.distanceTo)(s.input.self,e)/5e4),e=>.2*(s.target&&s.target.hash===e.hash?1:0)];return r.map((t=>t(e))).reduce(((e,t)=>e+t))/r.length}function _(){const e=t.tree.blackboard;e.target=null,e.canSeeTarget=!1,void 0!==e.targetLostSightTime&&delete e.targetLostSightTime,void 0!==e.targetLastKnownLocation&&delete e.targetLastKnownLocation,void 0!==e.targetPredictedLocation&&delete e.targetPredictedLocation}t.tree=new r.BehaviorTree({tree:n.BT_Root,blackboard:{target:null,eqsResults:{},actionStatus:new Map}}),t.onBegin=e=>{const s=t.tree.blackboard;s.optimalEngagementRange=-1;for(let t of e.self.weapons)if(void 0!==t.tags.find((e=>"Weapon.Secondary"===e))){s.secondaryWeapon=t,s.canUseSpecialAttack=!0;break}for(let t of e.self.weapons)if(void 0!==t.tags.find((e=>"Weapon.Melee"===e))){s.canMelee=!0;break}s.currentTime=0,console.log(`${e.self.hash}: ${e.self.name} AI Started`)},t.onTick=e=>{const s=t.tree.blackboard;0!==e.errors.length&&e.errors.forEach((e=>console.log(`${e.severity}: ${e.command}: ${e.message}`))),function(e){const s=t.tree.blackboard;s.input=e,s.currentTime+=e.deltaTime;const r=function(){const e=t.tree.blackboard,s=e.input.perception.sight,r=(e.input.perception.damage,e.target?s.findIndex((t=>t.hash===e.target.hash)):-1),a=s.filter((e=>function(e,s=!1){const r=t.tree.blackboard;return[()=>e.health>0,()=>r.input.self.factionID!==e.factionID,()=>(0,o.distanceTo)(r.input.self,e)<=5e4].map((e=>e())).reduce(((e,t)=>e&&t))}(e)));if(0===a.length)return-1===r?e.target:null;const n=a.map(T);return a[n.indexOf(Math.max(...n))]}();null===r?_():s.target=r,function(){const e=t.tree.blackboard,s=e.input.perception.sight;if(void 0!==e.damageInstigatorHash&&-1!==s.findIndex((t=>t.hash===e.damageInstigatorHash&&t.health<=0))&&function(){const e=t.tree.blackboard;void 0!==e.damageStimulusTime&&delete e.damageStimulusTime,void 0!==e.damageInstigatorHash&&delete e.damageInstigatorHash,void 0!==e.damageStimulusDirection&&delete e.damageStimulusDirection,void 0!==e.damageStimulusFocalPoint&&delete e.damageStimulusFocalPoint}(),e.target){if(0===s.length)e.canSeeTarget&&(e.targetLostSightTime=e.currentTime),e.canSeeTarget=!1;else{const t=-1!==s.findIndex((t=>t.hash===e.target.hash));e.canSeeTarget&&!t&&(e.targetLostSightTime=e.currentTime),e.canSeeTarget=t,e.canSeeTarget&&(e.targetLastKnownLocation=e.target.location,e.targetPredictedLocation=e.target.location,e.targetLastKnownVelocity=e.target.velocity)}void 0!==e.targetLastKnownLocation&&(e.targetPredictedLocation=(0,o.add)(e.targetPredictedLocation,(0,o.multiply)(e.targetLastKnownVelocity,e.input.deltaTime)))}}(),function(){const e=t.tree.blackboard,s=e.input.perception.damage;if(0===s.length)return;const r=s.filter((e=>!e.friendly));if(0===r.length)return;const a=r.length-1;e.damageStimulusTime=e.currentTime,e.damageInstigatorHash=r[a].instigatorHash,e.damageStimulusDirection=r[a].damageDirection,e.damageStimulusFocalPoint=(0,o.add)(e.input.self.location,(0,o.multiply)(e.damageStimulusDirection,1e4)),e.lastHitLocation=e.input.self.location,e.isLastDamageFromTarget=e.target&&e.target.hash===r[a].instigatorHash}(),function(){const e=t.tree.blackboard,s=e.input.perception.sound,r=e.input.self.location;if(0===s.length)return;const o=s.filter((e=>!e.friendly)),n=o.filter((e=>"Taunt"===e.tag&&a.AI.IsNavigable(e.location))),i=o.filter((e=>"Weapon"===e.tag&&a.AI.IsNavigable(e.location))),T=new l.Evaluator(i).addTest(new d.Test((e=>(0,u.scoreByDistance)(r,e.location)))).getBestItem(),_=new l.Evaluator(n).addTest(new d.Test((e=>(0,u.scoreByDistance)(r,e.location)))).getBestItem();void 0!==T&&(e.lastWeaponNoise=new c.Sound(T,e.currentTime)),void 0!==_&&(e.heardNoise=!0,e.noiseLocation=_.location)}(),function(){const e=t.tree.blackboard;if(0===e.input.perception.interactable.length)return void(void 0!==e.desiredPickupLocation&&delete e.desiredPickupLocation);const s=function(){const e=t.tree.blackboard,s=function(){const e=t.tree.blackboard,s=e.input.self,r=e=>1-s.health/s.healthMax,a=e=>1-s.shield/s.shieldMax,n=e=>1-Math.min(1,(0,o.distanceToVec)(s.location,e.location)/5e4),i=[r,e=>a()-1,n],c=[e=>r()-1,a,n];let l=[];for(const t of e.input.perception.interactable){let e=0;"Pickup.Heal"===t.tag?e=i.map((e=>e(t))).reduce(((e,t)=>e+t)):"Pickup.Shield"===t.tag?e=c.map((e=>e(t))).reduce(((e,t)=>e+t)):console.log("TODO for ammo crate"),l.push(e)}return l}(),r=s.indexOf(Math.max(...s));return s[r]>0?e.input.perception.interactable[r]:void 0}();void 0!==s&&a.AI.IsNavigable(s.location)&&(e.desiredPickupLocation=s.location)}()}(e),t.tree.step();for(let[t,r]of Object.entries(e.eqs))s.eqsResults[t]=r,2===r.status&&a.AI.EQS_Complete((0,i.StringToEQSQueryType)(t))},t.clearBlackboardTarget=_},"./src/predicates/Predicate_CloseCombat.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_CloseCombat=void 0;const r=s("./src/aiconfig.ts"),o=s("./src/helper.ts");t.Predicate_CloseCombat=e=>{if(!e.canMelee)return!1;if(void 0===e.targetLastKnownLocation)return!1;const t=e.input.self.location,s=(0,o.distanceToVec)(t,e.targetLastKnownLocation),a=e.actionStatus.get("Action.MeleeAttack");return void 0!==a&&a?s<=r.CURRENT_AI_CONFIG.closeCombatExitRange:s<=r.CURRENT_AI_CONFIG.closeCombatEnterRange}},"./src/predicates/Predicate_FocusToDamage.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToDamage=void 0;const r=s("./src/aiconfig.ts");t.Predicate_FocusToDamage=e=>void 0!==e.damageStimulusFocalPoint&&(void 0!==e.damageInstigatorHash&&(null===e.target||!e.canSeeTarget&&(!(e.damageStimulusTime<=e.targetLostSightTime)||!(e.currentTime-e.damageStimulusTime>=r.CURRENT_AI_CONFIG.damageStimulusTimeout)&&e.damageInstigatorHash!==e.target.hash)))},"./src/predicates/Predicate_FocusToPredictedLocation.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToPredictedLocation=void 0;const r=s("./src/aiconfig.ts");t.Predicate_FocusToPredictedLocation=e=>void 0!==e.targetPredictedLocation&&!(e.currentTime-e.targetLostSightTime>=r.CURRENT_AI_CONFIG.predictionTimeout)},"./src/predicates/Predicate_FocusToWeaponNoise.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToWeaponNoise=void 0;const r=s("./src/aiconfig.ts");t.Predicate_FocusToWeaponNoise=e=>!!e.lastWeaponNoise&&!(e.currentTime-e.lastWeaponNoise.time>=r.CURRENT_AI_CONFIG.weaponNoiseStimulusTimeout)},"./src/predicates/Predicate_HasLowShield.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HasLowShield=void 0;const r=s("./src/aiconfig.ts");t.HasLowShield=e=>{let t=e.input.self;return t.shield/t.shieldMax<=r.CURRENT_AI_CONFIG.lowShieldThreshold}},"./src/predicates/Predicate_HasVeryLowTotalHealth.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HasVeryLowTotalHealth=void 0;const r=s("./src/aiconfig.ts");t.HasVeryLowTotalHealth=e=>{let t=e.input.self;return(t.health+t.shield)/(t.healthMax+t.shieldMax)<=r.CURRENT_AI_CONFIG.veryLowTotalHealthThreshold}},"./src/predicates/Predicate_InRange.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetInRange=t.InRange=void 0;const r=s("./src/helper.ts");t.InRange=(e,t,s)=>o=>(0,r.distanceToVec)(e,t)<=s,t.TargetInRange=e=>s=>null!==s.target&&(0,t.InRange)(s.input.self.location,s.target.location,e)(s)},"./src/predicates/Predicate_IsInsideBattleZone.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsInsideBattleZone=t.Predicate_IsTargetInsideBattleZone=t.Predicate_IsLocationInsideBattleZone=void 0;const r=s("./src/index.ts"),o=s("./src/utils.ts");t.Predicate_IsLocationInsideBattleZone=e=>t=>{const s=t[e];return!!s&&!!(0,o.IsVector)(s)&&r.AI.IsInsideBattleZone(s)},t.Predicate_IsTargetInsideBattleZone=e=>{if(!e.target)return!1;const t=e.target.location;return r.AI.IsInsideBattleZone(t)},t.Predicate_IsInsideBattleZone=e=>{const t=e.input.self.location;return r.AI.IsInsideBattleZone(t)}},"./src/predicates/Predicate_IsOutnumbered.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsOutnumbered=void 0,t.IsOutnumbered=e=>{const t=e.input.self.factionID,s=e.input.perception.sight.filter((e=>e.factionID===t&&e.health>0)),r=e.input.perception.sight.filter((e=>e.factionID!==t&&e.health>0));return s.length+1<r.length}},"./src/predicates/Predicate_IsOutnumberingEnemies.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsOutnumberingEnemies=void 0,t.IsOutnumberingEnemies=e=>{const t=e.input.self.factionID,s=e.input.perception.sight.filter((e=>e.factionID===t&&e.health>0)),r=e.input.perception.sight.filter((e=>e.factionID!==t&&e.health>0));return s.length+1>r.length}},"./src/predicates/Predicate_IsUsingAction.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsUsingAction=void 0,t.Predicate_IsUsingAction=e=>t=>{const s=t.actionStatus.get(e);return void 0!==s&&s}},"./src/predicates/Predicate_TargetHasMoreTotalHealth.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetHasWayMoreTotalHealthRatio=t.TargetHasMoreTotalHealth=void 0,t.TargetHasMoreTotalHealth=e=>{const t=e.input.self,s=e.target;if(null===s)return!1;const r=t.health+t.shield;return s.health+s.shield>r},t.TargetHasWayMoreTotalHealthRatio=e=>{const t=e.input.self,s=e.target;if(null===s)return!1;const r=(t.health+t.shield)/(t.healthMax+t.shieldMax)-(s.health+s.shield)/(s.healthMax+s.shieldMax);return!(r>=0)&&r+.2<=0}},"./src/tasks/BTT_ClearTarget.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_ClearTarget=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/mech.ts");t.BTT_ClearTarget=new r.Task({run:e=>((0,o.clearBlackboardTarget)(),r.SUCCESS)})},"./src/tasks/BTT_LookAt.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_LookAt=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts"),a=s("./src/utils.ts");t.BTT_LookAt=e=>new r.Task({start:t=>{const s=t[e];if(s&&(0,a.IsVector)(s))return o.AI.LookAt(s)?r.SUCCESS:r.FAILURE},run:e=>{switch(o.AI.QueryStatus("Action.LookAt")){case 0:return r.RUNNING;case 2:default:return r.FAILURE;case 1:return r.SUCCESS}}})},"./src/tasks/BTT_MeleeAttack.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_MeleeAttack=void 0;const r=s("./src/index.ts"),o=s("./node_modules/behaviortree/lib/index.js");t.BTT_MeleeAttack=e=>new o.Task({run:t=>(r.AI.WeaponTrigger(e),t.actionStatus.set("Action.MeleeAttack",!0),o.RUNNING),end:t=>{r.AI.WeaponRelease(e),t.actionStatus.set("Action.MeleeAttack",!1)},abort:t=>{r.AI.WeaponRelease(e),t.actionStatus.set("Action.MeleeAttack",!1)}})},"./src/tasks/BTT_SetValue.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SetValue=void 0;const r=s("./node_modules/behaviortree/lib/index.js");t.BTT_SetValue=e=>new r.Task({run:t=>(e(t),r.SUCCESS)})},"./src/tasks/BTT_Shoot.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Shoot=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_Shoot=e=>new r.Task({start:t=>-1!==t.input.self.weapons.findIndex((t=>t.tags.findIndex((t=>t===e))))?r.SUCCESS:r.FAILURE,run:t=>{const s=o.AI.WeaponGetAmmoByTag(e)>0;return s?o.AI.WeaponTrigger(e,t.targetLastKnownLocation):o.AI.WeaponRelease(e),s?r.RUNNING:r.FAILURE},end:t=>{o.AI.WeaponRelease(e)},abort:t=>{o.AI.WeaponRelease(e)}})},"./src/tasks/BTT_SpecialAttack.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SpecialAttack=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts"),a=s("./src/utils.ts");t.BTT_SpecialAttack=e=>new r.Task({start:t=>{const s=t[e];if(!s||!(0,a.IsVector)(s))return r.FAILURE;if(void 0===t.secondaryWeapon||null===t.secondaryWeapon)return r.FAILURE;const n=o.AI.TrySpecialAttack(s);return n&&t.actionStatus.set("Action.SpecialAttack",!0),n?r.SUCCESS:r.FAILURE},run:e=>{switch(o.AI.QueryStatus("Action.SpecialAttack")){case 0:return r.RUNNING;case 2:default:return r.FAILURE;case 1:return r.SUCCESS}},end:e=>{e.actionStatus.set("Action.SpecialAttack",!1)},abort:e=>{e.actionStatus.set("Action.SpecialAttack",!1)}})},"./src/tasks/BTT_Success.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Success=void 0;const r=s("./node_modules/behaviortree/lib/index.js");t.BTT_Success=new r.Task({run:e=>r.SUCCESS})},"./src/tasks/BTT_Taunt.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Taunt=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_Taunt=new r.Task({start:e=>o.AI.Taunt()?r.SUCCESS:r.FAILURE,run:e=>{switch(o.AI.QueryStatus("Action.Taunt")){case 0:return r.RUNNING;case 2:default:return r.FAILURE;case 1:return r.SUCCESS}}})},"./src/tasks/BTT_Wait.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Wait=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_Wait=e=>new r.Task({start:t=>o.AI.Wait(e)?r.SUCCESS:r.FAILURE,run:e=>{switch(o.AI.QueryStatus("Action.Wait")){case 0:return r.RUNNING;case 2:default:return r.FAILURE;case 1:return r.SUCCESS}}})},"./src/tasks/environment/BTT_QuerySetArgument.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_QuerySetArgumentFloat=t.BTT_QuerySetArgumentVector=t.BTT_QuerySetArgumentString=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_QuerySetArgumentString=(e,t,s)=>new r.Task({run:a=>{const n=s(a);return o.AI.EQS_SetArgumentString(e,t,n),r.SUCCESS}}),t.BTT_QuerySetArgumentVector=(e,t,s)=>new r.Task({run:a=>{const n=s(a);return o.AI.EQS_SetArgumentVector(e,t,n),r.SUCCESS}}),t.BTT_QuerySetArgumentFloat=(e,t,s)=>new r.Task({run:a=>{const n=s(a);return o.AI.EQS_SetArgumentFloat(e,t,n),r.SUCCESS}})},"./src/tasks/environment/BTT_RunEQSQuery.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_RunEQSQuery=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_RunEQSQuery=(e,t)=>new r.Task({start:t=>(t.eqsResults[e]={status:1},o.AI.EQS_Query(e)?r.SUCCESS:r.FAILURE),run:s=>{const o=s.eqsResults[e];if(!o)return r.FAILURE;switch(o.status){case 1:return r.RUNNING;case 3:default:return r.FAILURE;case 2:return s[t]=s.eqsResults[e].location,r.SUCCESS}}})},"./src/tasks/focus/BTT_SetFocalPoint.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SetFocalPoint=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts"),a=s("./src/utils.ts"),n=s("./src/aiconfig.ts");t.BTT_SetFocalPoint=e=>new r.Task({start:t=>{n.ENABLE_DEBUGGING&&console.log("BTT_SetFocalPoint: Start called.");const s=t[e];return s?(n.ENABLE_DEBUGGING&&console.log("BTT_SetFocalPoint: Focus location: "+JSON.stringify(s)),(0,a.DoesProvideVectorContext)(s)?o.AI.SetFocalPointByLocation(s.getVectorValue())?r.SUCCESS:r.FAILURE:(0,a.IsWarMachine)(s)?o.AI.SetFocalPointByHash(s.hash)?r.SUCCESS:r.FAILURE:(0,a.IsVector)(s)?o.AI.SetFocalPointByLocation(s)?r.SUCCESS:r.FAILURE:(console.log("BTT_SetFocalPoint: Invalid focal point type."),r.FAILURE)):r.FAILURE},run:e=>r.SUCCESS})},"./src/tasks/movement/BTT_MoveTo.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_MoveTo=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts"),a=s("./src/utils.ts"),n=s("./src/aiconfig.ts");t.BTT_MoveTo=(e,t=!1,s=600,i=20)=>new r.Task({start:t=>{n.ENABLE_DEBUGGING&&console.log("BTT_MoveTo: Move To called.");const i=t[e];return i&&(0,a.IsVector)(i)?(n.ENABLE_DEBUGGING&&console.log("BTT_MoveTo: Move To Location: "+JSON.stringify(i)),o.AI.MoveToVector(i,s)?r.SUCCESS:r.FAILURE):r.FAILURE},run:n=>{if(t){const t=n[e];if(!t||!(0,a.IsVector)(t))return r.FAILURE;if(!o.AI.MoveToVector(t,s))return r.FAILURE}switch(o.AI.QueryMovementResult()){case 0:return r.RUNNING;case 1:return r.SUCCESS;default:return r.FAILURE}}})},"./src/tasks/movement/BTT_StopMoveTo.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_StopMoveTo=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/index.ts");t.BTT_StopMoveTo=new r.Task({run:e=>(o.AI.StopMoveTo(),r.SUCCESS)})},"./src/trees/BT_Camp.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Camp=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/branches/ParallelBackground.ts"),a=s("./src/decorators/IsSet.ts"),n=s("./src/trees/BT_GetCover.ts"),i=s("./src/trees/BT_LookAround.ts"),c=s("./src/trees/BT_SetFocal.ts"),l=s("./src/tasks/movement/BTT_MoveTo.ts"),d=s("./src/tasks/BTT_SetValue.ts"),u=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),T=s("./src/decorators/Predicate.ts");t.BT_Camp=new r.Sequence({nodes:[new o.ParallelBackground({nodes:[new r.Sequence({nodes:[new r.Selector({nodes:[(0,a.IsSet)(n.BT_GetCover,"coverLocation",!1),(0,T.Predicate)((0,l.BTT_MoveTo)("coverLocation"),(0,u.Predicate_IsLocationInsideBattleZone)("coverLocation"),!0,r.ObserverAborts.Self),n.BT_GetCover]}),(0,d.BTT_SetValue)((e=>e.coverLocation=void 0))]}),c.BT_SetFocal]}),i.BT_LookAround]})},"./src/trees/BT_CloseStrafe.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CloseStrafe=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=s("./src/tasks/movement/BTT_MoveTo.ts"),n=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),i=s("./src/tasks/BTT_SetValue.ts");t.BT_CloseStrafe=new r.Sequence({nodes:[(0,o.BTT_QuerySetArgumentString)("closeStrafe","TargetHash",(e=>e.target.hash)),(0,o.BTT_QuerySetArgumentVector)("closeStrafe","TargetLastKnownLocation",(e=>e.targetLastKnownLocation)),(0,o.BTT_QuerySetArgumentFloat)("closeStrafe","GridSize",(e=>4e3)),(0,o.BTT_QuerySetArgumentFloat)("closeStrafe","SpaceBetween",(e=>1e3)),(0,n.BTT_RunEQSQuery)("closeStrafe","closeStrafeLocation"),(0,a.BTT_MoveTo)("closeStrafeLocation"),(0,i.BTT_SetValue)((e=>e.closeStrafeLocation=void 0))]})},"./src/trees/BT_GetCover.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_GetCover=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=s("./src/tasks/movement/BTT_MoveTo.ts"),n=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),i=s("./src/tasks/BTT_SetValue.ts");t.BT_GetCover=new r.Sequence({nodes:[(0,o.BTT_QuerySetArgumentVector)("cover","TargetLastKnownLocation",(e=>void 0!==e.targetLastKnownLocation?e.targetLastKnownLocation:e.input.self.location)),(0,o.BTT_QuerySetArgumentVector)("cover","LastHitLocation",(e=>void 0!==e.lastHitLocation?e.lastHitLocation:e.input.self.location)),(0,n.BTT_RunEQSQuery)("cover","coverLocation"),(0,a.BTT_MoveTo)("coverLocation"),(0,i.BTT_SetValue)((e=>e.coverLocation=void 0))]})},"./src/trees/BT_GetPickup.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_GetPickup=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/branches/ParallelBackground.ts"),a=s("./src/tasks/movement/BTT_MoveTo.ts"),n=s("./src/tasks/BTT_SetValue.ts"),i=s("./src/trees/BT_SetFocal.ts"),c=s("./src/decorators/Predicate.ts"),l=s("./src/predicates/Predicate_IsInsideBattleZone.ts");t.BT_GetPickup=new o.ParallelBackground({nodes:[new r.Sequence({nodes:[new r.Selector({nodes:[(0,c.Predicate)((0,a.BTT_MoveTo)("desiredPickupLocation",!0),(0,l.Predicate_IsLocationInsideBattleZone)("desiredPickupLocation"),!0,r.ObserverAborts.Self)]}),(0,n.BTT_SetValue)((e=>e.desiredPickupLocation=void 0))]}),i.BT_SetFocal]})},"./src/trees/BT_InvestigateNoise.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_InvestigateNoise=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/movement/BTT_MoveTo.ts"),a=s("./src/tasks/BTT_SetValue.ts"),n=s("./src/tasks/focus/BTT_SetFocalPoint.ts"),i=s("./src/trees/BT_SearchHiddenLocation.ts"),c=s("./src/branches/ParallelBackground.ts"),l=s("./src/trees/BT_SetFocal.ts"),d=s("./src/decorators/Predicate.ts"),u=s("./src/predicates/Predicate_IsInsideBattleZone.ts");t.BT_InvestigateNoise=new c.ParallelBackground({nodes:[new r.Sequence({nodes:[(0,n.BTT_SetFocalPoint)("noiseLocation"),(0,d.Predicate)((0,o.BTT_MoveTo)("noiseLocation"),(0,u.Predicate_IsLocationInsideBattleZone)("noiseLocation"),!0,r.ObserverAborts.Self),(0,i.BT_SearchHiddenLocation)("noiseLocation"),(0,a.BTT_SetValue)((e=>e.noiseLocation=void 0)),(0,a.BTT_SetValue)((e=>e.heardNoise=!1))]}),l.BT_SetFocal]})},"./src/trees/BT_LookAround.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_LookAround=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/helper.ts"),a=s("./src/tasks/BTT_LookAt.ts"),n=s("./src/tasks/BTT_SetValue.ts"),i=s("./src/tasks/BTT_Wait.ts");t.BT_LookAround=new r.Sequence({nodes:[(0,n.BTT_SetValue)((e=>e.lookAtLocation=(0,o.add)(e.input.self.location,(0,o.multiply)((0,o.rotateZ)((0,o.getForwardVector)(e.input.self.rotation),90),1e3)))),(0,a.BTT_LookAt)("lookAtLocation"),(0,i.BTT_Wait)(1),(0,n.BTT_SetValue)((e=>e.lookAtLocation=(0,o.add)(e.input.self.location,(0,o.multiply)((0,o.rotateZ)((0,o.getForwardVector)(e.input.self.rotation),90),1e3)))),(0,a.BTT_LookAt)("lookAtLocation"),(0,i.BTT_Wait)(1),(0,n.BTT_SetValue)((e=>e.lookAtLocation=void 0))]})},"./src/trees/BT_Patrol.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Patrol=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/movement/BTT_MoveTo.ts"),a=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=s("./src/tasks/BTT_SetValue.ts"),i=s("./src/tasks/focus/BTT_SetFocalPoint.ts"),c=s("./src/tasks/environment/BTT_QuerySetArgument.ts"),l=s("./src/branches/ParallelBackground.ts"),d=s("./src/trees/BT_SetFocal.ts");t.BT_Patrol=new l.ParallelBackground({nodes:[new r.Sequence({nodes:[(0,c.BTT_QuerySetArgumentVector)("patrol","Origin",(e=>e.input.self.location)),(0,c.BTT_QuerySetArgumentFloat)("patrol","GridSize",(e=>25e3)),(0,a.BTT_RunEQSQuery)("patrol","patrolLocation"),(0,i.BTT_SetFocalPoint)("patrolLocation"),(0,o.BTT_MoveTo)("patrolLocation"),(0,n.BTT_SetValue)((e=>e.patrolLocation=void 0))]}),d.BT_SetFocal]})},"./src/trees/BT_ReceivedDamage.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_ReceivedDamage=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/helper.ts"),a=s("./src/tasks/BTT_LookAt.ts"),n=s("./src/tasks/BTT_SetValue.ts"),i=s("./src/tasks/movement/BTT_StopMoveTo.ts"),c=s("./src/trees/BT_SearchHiddenLocation.ts"),l=s("./src/branches/ParallelBackground.ts"),d=s("./src/trees/BT_SetFocal.ts");t.BT_ReceivedDamage=new r.Sequence({nodes:[i.BTT_StopMoveTo,(0,a.BTT_LookAt)("damageStimulusFocalPoint"),new l.ParallelBackground({nodes:[new r.Sequence({nodes:[(0,n.BTT_SetValue)((e=>e.damageStimulusFocalPoint=void 0)),(0,n.BTT_SetValue)((e=>e.damageHiddenLocation=(0,o.add)(e.input.self.location,(0,o.multiply)(e.damageStimulusDirection,1e4)))),(0,c.BT_SearchHiddenLocation)("damageHiddenLocation"),(0,n.BTT_SetValue)((e=>e.damageHiddenLocation=void 0))]}),d.BT_SetFocal]})]})},"./src/trees/BT_Root.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Root=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/decorators/CanActivateAction.ts"),a=s("./src/decorators/IsSet.ts"),n=s("./src/decorators/Predicate.ts"),i=s("./src/predicates/Predicate_HasLowShield.ts"),c=s("./src/tasks/BTT_Taunt.ts"),l=s("./src/tasks/BTT_Wait.ts"),d=s("./src/trees/BT_Camp.ts"),u=s("./src/trees/combat/BT_Combat.ts"),T=s("./src/trees/BT_GetPickup.ts"),_=s("./src/trees/BT_InvestigateNoise.ts"),h=s("./src/trees/BT_Patrol.ts"),p=s("./src/trees/BT_ReceivedDamage.ts"),S=s("./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts"),B=s("./src/predicates/Predicate_IsInsideBattleZone.ts");t.BT_Root=new r.Selector({nodes:[(0,a.IsSet)(u.BT_Combat,"target",!0,r.ObserverAborts.Both),(0,n.Predicate)(S.BT_ParallelMoveToBattleZone,B.Predicate_IsInsideBattleZone,!1,r.ObserverAborts.LowerPriority),(0,a.IsSet)(T.BT_GetPickup,"desiredPickupLocation",!0,r.ObserverAborts.Both),(0,n.Predicate)(d.BT_Camp,i.HasLowShield,!0,r.ObserverAborts.LowerPriority),(0,o.CanActivateAction)((0,n.Predicate)(c.BTT_Taunt,i.HasLowShield,!1),"Action.Taunt"),(0,a.IsSet)(p.BT_ReceivedDamage,"damageStimulusFocalPoint",!0,r.ObserverAborts.LowerPriority),(0,a.IsSet)(_.BT_InvestigateNoise,"heardNoise",!0,r.ObserverAborts.LowerPriority),h.BT_Patrol,(0,l.BTT_Wait)(1)]})},"./src/trees/BT_SearchHiddenLocation.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SearchHiddenLocation=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=s("./src/tasks/movement/BTT_MoveTo.ts"),n=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),i=s("./src/tasks/BTT_SetValue.ts"),c=s("./src/tasks/focus/BTT_SetFocalPoint.ts");t.BT_SearchHiddenLocation=e=>new r.Sequence({nodes:[(0,o.BTT_QuerySetArgumentVector)("hidden","TargetPredictedLocation",(t=>t[e])),(0,n.BTT_RunEQSQuery)("hidden","hiddenLocation"),(0,c.BTT_SetFocalPoint)("hiddenLocation"),(0,a.BTT_MoveTo)("hiddenLocation"),(0,i.BTT_SetValue)((e=>e.hiddenLocation=void 0))]})},"./src/trees/BT_SearchTarget.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SearchTarget=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/branches/ParallelBackground.ts"),a=s("./src/decorators/IsSet.ts"),n=s("./src/tasks/BTT_ClearTarget.ts"),i=s("./src/tasks/movement/BTT_MoveTo.ts"),c=s("./src/trees/BT_SetFocal.ts"),l=s("./src/trees/BT_SearchHiddenLocation.ts"),d=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),u=s("./src/decorators/Predicate.ts");t.BT_SearchTarget=new r.Sequence({nodes:[new o.ParallelBackground({nodes:[new r.Sequence({nodes:[(0,u.Predicate)((0,i.BTT_MoveTo)("targetLastKnownLocation"),(0,d.Predicate_IsLocationInsideBattleZone)("targetLastKnownLocation"),!0,r.ObserverAborts.Self),(0,a.IsSet)((0,l.BT_SearchHiddenLocation)("targetPredictedLocation"),"targetPredictedLocation")]}),c.BT_SetFocal]}),n.BTT_ClearTarget]})},"./src/trees/BT_SetFocal.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SetFocal=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/decorators/IsSet.ts"),a=s("./src/decorators/Predicate.ts"),n=s("./src/tasks/BTT_Success.ts"),i=s("./src/tasks/focus/BTT_SetFocalPoint.ts"),c=s("./src/predicates/Predicate_FocusToDamage.ts"),l=s("./src/predicates/Predicate_FocusToPredictedLocation.ts"),d=s("./src/predicates/Predicate_FocusToWeaponNoise.ts"),u=s("./src/tasks/BTT_SetValue.ts");t.BT_SetFocal=new r.Selector({nodes:[(0,o.IsSet)((0,i.BTT_SetFocalPoint)("target"),"canSeeTarget"),(0,a.Predicate)((0,i.BTT_SetFocalPoint)("damageStimulusFocalPoint"),c.Predicate_FocusToDamage),(0,a.Predicate)((0,i.BTT_SetFocalPoint)("targetPredictedLocation"),l.Predicate_FocusToPredictedLocation),(0,o.IsSet)((0,i.BTT_SetFocalPoint)("targetLastKnownLocation"),"targetLastKnownLocation"),(0,a.Predicate)(new r.Sequence({nodes:[(0,i.BTT_SetFocalPoint)("lastWeaponNoise"),(0,u.BTT_SetValue)((e=>e.lastWeaponNoise=void 0))]}),d.Predicate_FocusToWeaponNoise),n.BTT_Success]})},"./src/trees/BT_Strafe.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Strafe=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=s("./src/tasks/movement/BTT_MoveTo.ts"),n=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),i=s("./src/tasks/BTT_SetValue.ts");t.BT_Strafe=new r.Sequence({nodes:[(0,o.BTT_QuerySetArgumentString)("strafe","TargetHash",(e=>e.target.hash)),(0,o.BTT_QuerySetArgumentFloat)("strafe","GridSize",(e=>1e4)),(0,n.BTT_RunEQSQuery)("strafe","strafeLocation"),(0,a.BTT_MoveTo)("strafeLocation"),(0,i.BTT_SetValue)((e=>e.strafeLocation=void 0))]})},"./src/trees/battlezone/BT_MoveToBattleZone.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_MoveToBattleZone=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/tasks/movement/BTT_MoveTo.ts"),a=s("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=s("./src/tasks/BTT_SetValue.ts"),i=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),c=s("./src/decorators/Predicate.ts");t.BT_MoveToBattleZone=new r.Sequence({nodes:[(0,a.BTT_RunEQSQuery)("battleZone","battleZoneLocation"),(0,c.Predicate)((0,o.BTT_MoveTo)("battleZoneLocation"),(0,i.Predicate_IsLocationInsideBattleZone)("battleZoneLocation"),!0,r.ObserverAborts.Self),(0,n.BTT_SetValue)((e=>e.battleZoneLocation=void 0))]})},"./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_ParallelMoveToBattleZone=void 0;const r=s("./src/branches/ParallelBackground.ts"),o=s("./src/trees/BT_SetFocal.ts"),a=s("./src/trees/battlezone/BT_MoveToBattleZone.ts");t.BT_ParallelMoveToBattleZone=new r.ParallelBackground({nodes:[a.BT_MoveToBattleZone,o.BT_SetFocal]})},"./src/trees/combat/BT_CanSeeTarget.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CanSeeTarget=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/decorators/CanActivateAction.ts"),a=s("./src/decorators/Predicate.ts"),n=s("./src/tasks/BTT_SpecialAttack.ts"),i=s("./src/trees/combat/BT_CloseCombat.ts"),c=s("./src/trees/combat/BT_RangeCombat.ts"),l=s("./src/predicates/Predicate_CloseCombat.ts");t.BT_CanSeeTarget=new r.Selector({nodes:[(0,o.CanActivateAction)((0,n.BTT_SpecialAttack)("targetLastKnownLocation"),"Action.SpecialAttack",!0,r.ObserverAborts.LowerPriority),(0,a.Predicate)(i.BT_CloseCombat,l.Predicate_CloseCombat,!0,r.ObserverAborts.Both),c.BT_RangeCombat]})},"./src/trees/combat/BT_CloseCombat.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CloseCombat=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/branches/ParallelBackground.ts"),a=s("./src/decorators/IsSet.ts"),n=s("./src/decorators/Predicate.ts"),i=s("./src/predicates/Predicate_HasVeryLowTotalHealth.ts"),c=s("./src/tasks/BTT_MeleeAttack.ts"),l=s("./src/tasks/movement/BTT_MoveTo.ts"),d=s("./src/tasks/BTT_Success.ts"),u=s("./src/trees/BT_GetCover.ts"),T=s("./src/trees/BT_GetPickup.ts"),_=s("./src/trees/BT_CloseStrafe.ts"),h=s("./src/predicates/Predicate_InRange.ts"),p=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),S=s("./src/trees/battlezone/BT_MoveToBattleZone.ts"),B=s("./src/tasks/focus/BTT_SetFocalPoint.ts"),b=s("./src/predicates/Predicate_IsOutnumbered.ts"),g=s("./src/trees/BT_Strafe.ts"),v=s("./src/predicates/Predicate_TargetHasMoreTotalHealth.ts");t.BT_CloseCombat=new o.ParallelBackground({nodes:[(0,c.BTT_MeleeAttack)("Weapon.Melee"),(0,B.BTT_SetFocalPoint)("target"),new r.Selector({nodes:[(0,n.Predicate)(S.BT_MoveToBattleZone,p.Predicate_IsInsideBattleZone,!1,r.ObserverAborts.LowerPriority),(0,a.IsSet)(T.BT_GetPickup,"desiredPickupLocation",!0,r.ObserverAborts.Both),(0,n.Predicate)(u.BT_GetCover,i.HasVeryLowTotalHealth,!0,r.ObserverAborts.LowerPriority),(0,n.Predicate)(g.BT_Strafe,(e=>(0,b.IsOutnumbered)(e)||(0,v.TargetHasWayMoreTotalHealthRatio)(e)),!0,r.ObserverAborts.LowerPriority),(0,n.Predicate)((0,l.BTT_MoveTo)("targetLastKnownLocation",!0),(e=>!(0,h.TargetInRange)(2e3)(e)&&(0,p.Predicate_IsTargetInsideBattleZone)(e)),!0,r.ObserverAborts.LowerPriority),_.BT_CloseStrafe,d.BTT_Success]})]})},"./src/trees/combat/BT_Combat.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Combat=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/decorators/IsSet.ts"),a=s("./src/decorators/Predicate.ts"),n=s("./src/predicates/Predicate_HasLowShield.ts"),i=s("./src/trees/BT_Camp.ts"),c=s("./src/trees/combat/BT_CanSeeTarget.ts"),l=s("./src/trees/BT_GetPickup.ts"),d=s("./src/trees/BT_SearchTarget.ts"),u=s("./src/tasks/BTT_Success.ts"),T=s("./src/trees/BT_Patrol.ts"),_=s("./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts"),h=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),p=s("./src/predicates/Predicate_IsUsingAction.ts");t.BT_Combat=new r.Selector({nodes:[(0,a.Predicate)(c.BT_CanSeeTarget,(e=>e.canSeeTarget||(0,p.Predicate_IsUsingAction)("Action.SpecialAttack")(e)),!0,r.ObserverAborts.Both),(0,a.Predicate)(_.BT_ParallelMoveToBattleZone,h.Predicate_IsInsideBattleZone,!1,r.ObserverAborts.LowerPriority),(0,o.IsSet)(l.BT_GetPickup,"desiredPickupLocation",!0,r.ObserverAborts.Both),(0,a.Predicate)(i.BT_Camp,n.HasLowShield,!0,r.ObserverAborts.LowerPriority),(0,a.Predicate)(d.BT_SearchTarget,(e=>!e.canSeeTarget)),T.BT_Patrol,u.BTT_Success]})},"./src/trees/combat/BT_RangeCombat.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_RangeCombat=void 0;const r=s("./node_modules/behaviortree/lib/index.js"),o=s("./src/branches/ParallelBackground.ts"),a=s("./src/decorators/IsSet.ts"),n=s("./src/decorators/Predicate.ts"),i=s("./src/predicates/Predicate_HasVeryLowTotalHealth.ts"),c=s("./src/predicates/Predicate_IsOutnumbered.ts"),l=s("./src/predicates/Predicate_IsOutnumberingEnemies.ts"),d=s("./src/predicates/Predicate_TargetHasMoreTotalHealth.ts"),u=s("./src/tasks/movement/BTT_MoveTo.ts"),T=s("./src/tasks/BTT_Shoot.ts"),_=s("./src/tasks/BTT_Success.ts"),h=s("./src/trees/BT_GetCover.ts"),p=s("./src/trees/BT_GetPickup.ts"),S=s("./src/trees/BT_Strafe.ts"),B=s("./src/trees/BT_CloseStrafe.ts"),b=s("./src/trees/battlezone/BT_MoveToBattleZone.ts"),g=s("./src/predicates/Predicate_IsInsideBattleZone.ts"),v=s("./src/tasks/focus/BTT_SetFocalPoint.ts");t.BT_RangeCombat=new o.ParallelBackground({nodes:[new r.Parallel({nodes:[(0,T.BTT_Shoot)("Weapon.Primary.LeftArm"),(0,T.BTT_Shoot)("Weapon.Primary.RightArm")]}),(0,v.BTT_SetFocalPoint)("target"),new r.Selector({nodes:[(0,n.Predicate)(b.BT_MoveToBattleZone,g.Predicate_IsInsideBattleZone,!1,r.ObserverAborts.LowerPriority),(0,a.IsSet)(p.BT_GetPickup,"desiredPickupLocation",!0,r.ObserverAborts.Both),(0,n.Predicate)(h.BT_GetCover,i.HasVeryLowTotalHealth,!0,r.ObserverAborts.LowerPriority),(0,n.Predicate)(new r.Selector({nodes:[B.BT_CloseStrafe,(0,u.BTT_MoveTo)("targetLastKnownLocation")]}),(e=>!(0,d.TargetHasMoreTotalHealth)(e)&&!(0,c.IsOutnumbered)(e)||(0,l.IsOutnumberingEnemies)(e)),!0,r.ObserverAborts.Both),S.BT_Strafe,_.BTT_Success]})]})},"./src/utility/evaluator.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Evaluator=void 0,t.Evaluator=class{constructor(e,t){this.items=void 0!==e?e:[],this.tests=void 0!==t?t:[]}addItem(e){return this.items.push(e),this}addItems(e){return this.items.push(...e),this}addTest(e){return this.tests.push(e),this}getBestItem(){const e=this.run(),t=e.indexOf(Math.max(...e));return-1!==t?this.items[t]:void 0}run(){return this.items.map((e=>this.tests.map((t=>t.getScore(e))).reduce(((e,t)=>e+t))))}}},"./src/utility/helper.ts":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterByTime=t.scoreByDistance=void 0;const r=s("./src/helper.ts");t.scoreByDistance=(e,t)=>1-Math.min(1,(0,r.distanceToVec)(e,t)/2e5),t.filterByTime=(e,t,s)=>t-e>=s},"./src/utility/test.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Test=void 0,t.Test=class{constructor(e){this.scoreFunc=e}getScore(e){return this.scoreFunc(e)}}},"./src/utils.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoesProvideVectorContext=t.IsWarMachine=t.IsVector=t.StringToEQSQueryType=void 0,t.StringToEQSQueryType=e=>{switch(e){case"away":return"away";case"cover":return"cover";case"hidden":return"hidden";case"patrol":return"patrol";case"strafe":return"strafe";case"closeStrafe":return"closeStrafe";case"battleZone":return"battleZone"}},t.IsVector=e=>"X"in e&&"Y"in e,t.IsWarMachine=e=>"hash"in e,t.DoesProvideVectorContext=e=>"getVectorValue"in e}},t={};!function s(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,s),a.exports}("./src/mech.ts")})();
//# sourceMappingURL=mech.js.map