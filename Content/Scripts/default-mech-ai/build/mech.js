/*! For license information please see mech.js.LICENSE.txt */
(()=>{var e={"./node_modules/behaviortree/lib/index.js":e=>{var t,r=Object.defineProperty,s=Object.defineProperties,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,u=(e,t)=>{for(var r in t||(t={}))c.call(t,r)&&d(e,r,t[r]);if(i)for(var r of i(t))l.call(t,r)&&d(e,r,t[r]);return e},T=(e,t)=>s(e,a(t)),_=(e,t)=>{var r={};for(var s in e)c.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&i)for(var s of i(e))t.indexOf(s)<0&&l.call(e,s)&&(r[s]=e[s]);return r},h=(e,t)=>{for(var s in t)r(e,s,{get:t[s],enumerable:!0})},p=(t="undefined"!=typeof WeakMap?new WeakMap:0,(e,s)=>t&&t.get(e)||(s=((e,t,s,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of n(t))!c.call(e,s)&&r(e,s,{get:()=>t[s],enumerable:!(a=o(t,s))||a.enumerable});return e})(r({},"__esModule",{value:!0}),e),t&&t.set(e,s),s)),S={};h(S,{BehaviorTree:()=>R,BehaviorTreeImporter:()=>Q,BranchNode:()=>D,Decorator:()=>F,FAILURE:()=>v,Introspector:()=>Z,Node:()=>y,ObserverAborts:()=>O,Parallel:()=>q,ParallelComplete:()=>K,ParallelSelector:()=>X,RUNNING:()=>g,Random:()=>V,SUCCESS:()=>m,Selector:()=>W,Sequence:()=>G,Task:()=>I,decorators:()=>C,default:()=>Y,getRegistry:()=>M,registryLookUp:()=>k});var g=Symbol("running"),m=!0,v=!1;function B(e){return e===g||"object"==typeof e&&e.total===g}var b=()=>!1,P=()=>!0,f=()=>{},A=()=>{},y=class{constructor(e){this.nodeType="Node",this.ranStart=!1;var t=e,{run:r=b,start:s=P,end:o=f,abort:a=A}=t,n=_(t,["run","start","end","abort"]);this.blueprint=u({run:r,start:s,end:o,abort:a},n)}run(e,t={}){var r=t,{introspector:s,rerun:o=!1,registryLookUp:a=(e=>e)}=r,n=_(r,["introspector","rerun","registryLookUp"]);if(!o||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===v)return t}let i=this.blueprint.run(e,T(u({},n),{rerun:o,registryLookUp:a}));return i!==g&&this.blueprint.end(e),s&&s.push(this,i,e),i}abort(e,{registryLookUp:t=(e=>e),lastRun:r}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:r})}get name(){return this._name||this.blueprint.name}set name(e){this._name=e}},I=class extends y{constructor(){super(...arguments),this.nodeType="Task"}},L={};function M(){return L}function k(e){if("string"==typeof e){let t=L[e];if(!t)throw new Error(`No node with name ${e} registered.`);return t}return e}var R=class{constructor({tree:e,blackboard:t}){this.tree=e,this.blackboard=t,this.lastResult=void 0}step({introspector:e}={}){let t=this.lastResult&&"object"==typeof this.lastResult?this.lastResult:void 0,r=B(this.lastResult);e&&e.start(this),this.lastResult=k(this.tree).run(this.blackboard,{lastRun:t,introspector:e,rerun:r,registryLookUp:k}),e&&e.end()}static register(e,t){L[e]="function"==typeof t?new I({name:e,run:t}):t}static cleanRegistry(){L={}}},C={};h(C,{AlwaysFailDecorator:()=>E,AlwaysSucceedDecorator:()=>x,CooldownDecorator:()=>N,InvertDecorator:()=>H,LoopDecorator:()=>j});var w,O=((w=O||{})[w.None=0]="None",w[w.Self=1]="Self",w[w.LowerPriority=2]="LowerPriority",w[w.Both=3]="Both",w),U=e=>"observerAborts"in e,F=class extends y{constructor(e={config:{}}){var t=e,{config:r={}}=t;super(_(t,["config"])),this.nodeType="Decorator",this.observerAborts=0,this.setConfig(r)}condition(e){return m}decorate(e,t,r,s){return this.condition(t)||s&&1!==this.observerAborts&&3!==this.observerAborts?e(e,t,r):v}run(e,t={}){var r=t,{introspector:s,rerun:o,registryLookUp:a=(e=>e)}=r,n=_(r,["introspector","rerun","registryLookUp"]);if(!o||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===v)return t}let i=0,c=this.decorate((()=>(++i,a(this.blueprint.node).run(e,T(u({},n),{rerun:o,introspector:s,registryLookUp:a})))),e,this.config,o);return c!==g&&(this.blueprint.end(e),void 0!==(c===v&&this.blueprint.node)&&this.blueprint.node.blueprint.end(e)),s&&s.wrapLast(i,this,c,e),c}abort(e,{registryLookUp:t=(e=>e),lastRun:r}={}){super.abort(e,{registryLookUp:t,lastRun:r}),void 0!==this.blueprint.node&&this.blueprint.node.abort(e,{registryLookUp:t,lastRun:r})}setConfig(e){this.config=e}},E=class extends F{constructor(){super(...arguments),this.nodeType="AlwaysFailDecorator"}decorate(e){let t=e();return B(t)?t:v}},x=class extends F{constructor(){super(...arguments),this.nodeType="AlwaysSucceedDecorator"}decorate(e){let t=e();return B(t)?t:m}},N=class extends F{constructor(){super(...arguments),this.lock=!1,this.nodeType="CooldownDecorator"}setConfig({cooldown:e=5}){this.config={cooldown:e}}decorate(e){if(this.lock)return v;let t=e();return B(t)||(this.lock=!0,setTimeout((()=>{this.lock=!1}),1e3*this.config.cooldown)),t}},H=class extends F{constructor(){super(...arguments),this.nodeType="InvertDecorator"}decorate(e){let t=e();return B(t)?t:t===m?v:m}},j=class extends F{constructor(){super(...arguments),this.nodeType="LoopDecorator"}setConfig({loop:e=1/0}){this.config={loop:e}}decorate(e){let t=0,r=v;for(;t++<this.config.loop;)if(r=e(),r===v)return v;return r}},D=class extends y{constructor(e){super(e),this.OPT_OUT_CASE=m,this.START_CASE=m,this.nodeType="BranchNode",this.nodes=e.nodes||[],this.numNodes=this.nodes.length,this.observedDecorators=new Map}run(e={},{lastRun:t,introspector:r,rerun:s,registryLookUp:o=(e=>e)}={}){if(!s||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===v)return t}let a=this.START_CASE,n=[],i="object"==typeof t&&t.state||[],c=Math.max(i.findIndex((e=>B(e))),0),l=0;for(;l<this.numNodes;++l){let t=!1;if(s&&this.observedDecorators.has(l))t=!0;else if(l<c){n[l]=i[l];continue}let d=o(this.nodes[l]),u=!!U(d)&&d.condition(e);if(t&&U(d))if(this.observedDecorators.get(l)===u){if(s&&l<c){n[l]=i[l];continue}}else(2!==d.observerAborts||l!==c)&&(o(this.nodes[c]).abort(e,{registryLookUp:o,lastRun:i[c]}),s=!1,c=0);let T=d.run(e,{lastRun:i[l],introspector:r,rerun:s,registryLookUp:o});if(n[l]=T,U(d)&&d.observerAborts>0&&this.observedDecorators.set(l,u),T===g||"object"==typeof T){a=g;break}if(T===this.OPT_OUT_CASE){a=T;break}s=!1}let d=B(a);if(d||this.blueprint.end(e),r){let t=d?g:a;r.wrapLast(Math.min(l+1,this.numNodes),this,t,e)}return a===g?{total:a,state:n}:a}abort(e={},{lastRun:t,registryLookUp:r=(e=>e)}={}){super.abort(e,{registryLookUp:r,lastRun:t});let s="object"==typeof t&&t.state||[];0===s.length&&console.log("Warning: Called abort on empty run states.");let o=s.findIndex(B);-1===o&&(console.log("Warning: Called abort on a branch node that has no running nodes."),o=0),r(this.nodes[o]).abort(e,{registryLookUp:r,lastRun:s[o]})}},V=class extends D{constructor(){super(...arguments),this.nodeType="Random"}run(e={},{lastRun:t,introspector:r,rerun:s,registryLookUp:o=(e=>e)}={}){let a=0;s?a=t.state.findIndex((e=>B(e))):(this.blueprint.start(e),a=Math.floor(Math.random()*this.numNodes));let n=o(this.nodes[a]).run(e,{lastRun:t,introspector:r,rerun:s,registryLookUp:o}),i=B(n);if(i||this.blueprint.end(e),r){let t=i?g:n;r.wrapLast(1,this,t,e)}if(i){let e={total:g,state:new Array(this.numNodes).fill(void 0)};return e.state[a]=n,e}return n}},W=class extends D{constructor(){super(...arguments),this.nodeType="Selector",this.START_CASE=v,this.OPT_OUT_CASE=m}},G=class extends D{constructor(){super(...arguments),this.nodeType="Sequence",this.START_CASE=m,this.OPT_OUT_CASE=v}},Q=class{constructor(){this.types={task:I,decorator:F,selector:W,sequence:G,random:V,invert:H,fail:E,succeed:x,cooldown:N,loop:j}}defineType(e,t){this.types[e]=t}parse(e){let t=e,{type:r,name:s}=t,o=_(t,["type","name"]),a=this.types[r];if(!a){let e=k(r);if(e)return e.name=s,e;throw new Error(`Don't know how to handle type ${r}. Please register this first.`)}return new a({name:s,node:e.node?this.parse(e.node):null,nodes:e.nodes?e.nodes.map((e=>this.parse(e))):null,config:o})}},Z=class{constructor(){this.currentResult=[],this.results=[]}start(e){this.tree=e,this.currentResult=[]}end(){let e=this.currentResult.pop();e&&this.results.push(e),delete this.tree,this.currentResult=[]}push(e,t,r){this.currentResult.push(this._toResult(e,t,r))}wrapLast(e,t,r,s){let o=this.currentResult.splice(this.currentResult.length-e,e);this.currentResult.push(T(u({},this._toResult(t,r,s)),{children:o}))}_toResult(e,t,r){return T(u({},e.name?{name:e.name}:{}),{result:t})}reset(){this.results=[]}get lastResult(){return 0===this.results.length?null:this.results[this.results.length-1]}},q=class extends D{constructor(e){super(e),this.nodeType="Parallel",this.nodes=e.nodes||[],this.numNodes=this.nodes.length}run(e={},{lastRun:t,introspector:r,rerun:s,registryLookUp:o=(e=>e)}={}){if(!s||!this.ranStart){this.ranStart=!0;let t=this.blueprint.start(e);if(t===v)return t}let a=[];for(let n=0;n<this.numNodes;++n){let i=t&&t.state[n];if(i&&!B(i)){a[n]=i;continue}let c=o(this.nodes[n]).run(e,{lastRun:i,introspector:r,rerun:s,registryLookUp:o});a[n]=c}let n=this.calcResult(a);if(B(n)||this.blueprint.end(e),r){let t=a.find((e=>B(e)))?g:n;r.wrapLast(this.numNodes,this,t,e)}return n}calcResult(e){return e.includes(v)?v:e.find((e=>B(e)))?{total:g,state:e}:m}abort(e,{registryLookUp:t=(e=>e),lastRun:r}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:r});for(let s=0;s<this.numNodes;++s){let o=this.nodes[s],a=r&&r.state[s];a&&B(a)&&o.abort(e,{registryLookUp:t,lastRun:a})}}},K=class extends q{constructor(){super(...arguments),this.nodeType="ParallelComplete"}calcResult(e){return e.includes(v)?v:e.includes(m)?m:{total:g,state:e}}},X=class extends q{constructor(){super(...arguments),this.nodeType="ParallelSelector"}calcResult(e){return e.includes(v)?v:e.find((e=>B(e)))?{total:g,state:e}:m}},Y=R;e.exports=p(S)},"./node_modules/linked-list-typescript/lib/src/index.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(...e){this._head=this._tail=null,this._length=0,e.length>0&&e.forEach((e=>{this.append(e)}))}*iterator(){let e=this._head;for(;e;)yield e.value,e=e.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(e,t,r=!1){if(r&&this.isDuplicate(e))return!1;let o=new s(e),a=this._head;if(!a)return!1;for(;;){if(a.value===t)return o.next=a.next,o.prev=a,a.next=o,o.next?o.next.prev=o:this._tail=o,this._length++,!0;if(!a.next)return!1;a=a.next}}append(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new s(e);return this._tail?(this._tail.next=r,r.prev=this._tail,this._tail=r):this._head=this._tail=r,this._length++,!0}prepend(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new s(e);return this._head?(r.next=this._head,this._head.prev=r,this._head=r):this._head=this._tail=r,this._length++,!0}remove(e){let t=this._head;if(t){if(t.value===e)return this._head=t.next,this._head.prev=null,t.next=t.prev=null,this._length--,t.value;for(;;){if(t.value===e)return t.next?(t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null):(t.prev.next=null,this._tail=t.prev,t.next=t.prev=null),this._length--,t.value;if(!t.next)return;t=t.next}}}removeHead(){let e=this._head;if(e)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}removeTail(){let e=this._tail;if(e)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}first(e){let t=this.iterator(),r=[],s=Math.min(e,this.length);for(let e=0;e<s;e++){let e=t.next();r.push(e.value)}return r}toArray(){return[...this]}isDuplicate(e){return new Set(this.toArray()).has(e)}}t.LinkedList=r;class s{constructor(e){this.value=e,this.next=null,this.prev=null}}t.LinkedListItem=s},"./node_modules/queue-typescript/lib/src/index.js":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r("./node_modules/linked-list-typescript/lib/src/index.js");class o extends s.LinkedList{constructor(...e){super(...e)}get front(){return this.head}enqueue(e){this.append(e)}dequeue(){return this.removeHead()}}t.Queue=o},"./src/Sound.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sound=void 0,t.Sound=class{constructor(e,t){this.time=t,this.soundDetail=e}getVectorValue(){return this.soundDetail.Location}}},"./src/aiconfig.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROCKET_POD_ACTIVATION_TIME=t.BOSTON_SWORD_ACTIVATION_TIME=t.ZAIBATSU_SWORD_ACTIVATION_TIME=t.ENABLE_DEBUGGING=t.CURRENT_AI_CONFIG=void 0,t.CURRENT_AI_CONFIG={enableUserAction:!1,optimalRangeMultiplier:1.1,closeCombatEnterRange:2250,closeCombatExitRange:3e3,closeCombatKeepRange:2e3,lowShieldThreshold:.5,veryLowTotalHealthThreshold:.5,damageStimulusTimeout:10,predictionTimeout:10,predictionUpdateInterval:3,tauntNoiseStimulusTimeout:30,weaponNoiseStimulusTimeout:5,sprintOnLostTargetTimeout:5,sightMaxDistance:6e4,defaultMovementMode:"Walk"},t.ENABLE_DEBUGGING=!1,t.ZAIBATSU_SWORD_ACTIVATION_TIME=2,t.BOSTON_SWORD_ACTIVATION_TIME=1,t.ROCKET_POD_ACTIVATION_TIME=1},"./src/branches/ParallelBackground.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParallelBackground=void 0;const s=r("./node_modules/behaviortree/lib/index.js");class o extends s.Parallel{constructor(){super(...arguments),this.nodeType="ParallelBackground"}run(e={},{lastRun:t,introspector:r,rerun:o,registryLookUp:c=(e=>e)}={}){if(!o||!this.ranStart){this.ranStart=!0;const t=this.blueprint.start(e);if(t===s.FAILURE)return t}const l=[];for(let s=0;s<this.numNodes;++s){const d=t&&t.state[s];if(d&&!a(d)){if(l[s]=d,0===s)break;if(n(d))break}const u=c(this.nodes[s]),T=!i(d)&&o,_=d,h=u.run(e,{lastRun:_,introspector:r,rerun:T,registryLookUp:c});if(l[s]=h,0===s&&n(h))break}const d=this.calcResult(l);if((n(d)||i(l[0]))&&this.blueprint.end(e),r){const t=l.find((e=>a(e)))?s.RUNNING:d;r.wrapLast(this.numNodes,this,t,e)}return i(l[0])?s.SUCCESS:d}abort(e,{registryLookUp:t=(e=>e),lastRun:r}={}){this.blueprint.abort(e,{registryLookUp:t,lastRun:r});for(let s=0;s<this.numNodes;++s){const o=this.nodes[s],n=r&&r.state[s];n&&a(n)&&o.abort(e,{registryLookUp:t,lastRun:n})}}calcResult(e){return e.includes(s.FAILURE)?s.FAILURE:e.find((e=>a(e)))?{total:s.RUNNING,state:e}:s.SUCCESS}}t.ParallelBackground=o;const a=e=>e===s.RUNNING||"object"==typeof e&&e.total===s.RUNNING,n=e=>e===s.FAILURE||"object"==typeof e&&e.total===s.FAILURE,i=e=>e===s.SUCCESS||"object"==typeof e&&e.total===s.SUCCESS},"./src/damage.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Damage=void 0,t.Damage=class{constructor(e,t){this.time=e,this.damageDetails=t}}},"./src/damagetracker.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DamageTracker=void 0;const s=r("./node_modules/queue-typescript/lib/src/index.js");class o{constructor(...e){this.maxHistoryCount=Math.max(e.length,30),this.damageDetailHistory=new s.Queue(...e)}add(e){this.damageDetailHistory.enqueue(e),this.damageDetailHistory.length>this.maxHistoryCount&&this.damageDetailHistory.dequeue()}}t.DamageTracker=class{constructor(){this.damageTracker=new Map}addDamage(...e){for(const t of e){const e=this.damageTracker.get(t.damageDetails.InstigatorHash);void 0===e?this.damageTracker.set(t.damageDetails.InstigatorHash,new o(t)):e.add(t)}}getTotalDamageByTime(e,t,r){const s=this.damageTracker.get(r);return void 0===s?0:[...s.damageDetailHistory].filter((r=>r.time>=e-t)).map((e=>e.damageDetails.Amount)).reduce(((e,t)=>e+t),0)}}},"./src/decorators/IsSet.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsSet=void 0;const s=r("./node_modules/behaviortree/lib/index.js");class o extends s.Decorator{constructor(){super(...arguments),this.nodeType="IsSetDecorator"}setConfig(e){this.config=e,this.observerAborts=e.observerAborts}condition(e){return!!e[this.config.blackboardKey]===this.config.isSet}}t.IsSet=(e,t,r=!0,a=s.ObserverAborts.None)=>new o({node:e,config:{blackboardKey:t,isSet:r,observerAborts:a}})},"./src/decorators/Predicate.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate=t.PredicateDecorator=void 0;const s=r("./node_modules/behaviortree/lib/index.js");class o extends s.Decorator{constructor(){super(...arguments),this.nodeType="PredicateDecorator"}setConfig(e){this.config=e,this.observerAborts=e.observerAborts}condition(e){return!!this.config.predicate(e)===this.config.isMatch}}t.PredicateDecorator=o,t.Predicate=(e,t,r=!0,a=s.ObserverAborts.None)=>new o({node:e,config:{predicate:t,isMatch:r,observerAborts:a}})},"./src/helper.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getForwardVector=t.fmod=t.size=t.rotateZ=t.multiply=t.add=t.distanceToVec=t.distanceTo=t.isDead=void 0,t.isDead=function(e){return e.Health<=0},t.distanceTo=(e,r)=>(0,t.distanceToVec)(e.Location,r.Location),t.distanceToVec=(e,t)=>{const{X:r,Y:s,Z:o}=e,{X:a,Y:n,Z:i}=t,c={X:a-r,Y:n-s,Z:i-o};return Math.sqrt(Math.pow(c.X,2)+Math.pow(c.Y,2)+Math.pow(c.Z,2))},t.add=(e,t)=>{const{X:r,Y:s,Z:o}=e,{X:a,Y:n,Z:i}=t;return{X:r+a,Y:s+n,Z:o+i}},t.multiply=(e,t)=>{const{X:r,Y:s,Z:o}=e;return{X:r*t,Y:s*t,Z:o*t}},t.rotateZ=(e,t)=>{const r=t*(Math.PI/180),{X:s,Y:o,Z:a}=e;return{X:s*Math.cos(r)-o*Math.sin(r),Y:s*Math.sin(r)+o*Math.cos(r),Z:a}},t.size=e=>Math.sqrt(e.X*e.X+e.Y*e.Y+e.Z*e.Z),t.fmod=(e,t)=>{Math.abs(t);const r=e/t;return e-t*Math.trunc(r)},t.getForwardVector=e=>{const{X:r,Y:s,Z:o}=e,a=e=>e*(Math.PI/180),n=(0,t.fmod)(s,360),i=(0,t.fmod)(o,360),c=Math.sin(a(n)),l=Math.cos(a(n)),d=Math.sin(a(i));return{X:l*Math.cos(a(i)),Y:l*d,Z:c}}},"./src/index.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AI=void 0;const s=r("./src/mech.ts");t.AI=Context.GetOwner(),Context.OnMessage=(e,t)=>{try{switch(e){case"onTick":(0,s.onTick)(JSON.parse(t));break;case"onBegin":(0,s.onBegin)(JSON.parse(t))}}catch(e){console.log(e.stack)}}},"./src/mech.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearBlackboardTarget=t.updateBlackboardAmmo=t.onTick=t.onBegin=t.tree=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/helper.ts"),a=r("./src/index.ts"),n=r("./src/trees/BT_Root.ts"),i=r("./src/utils.ts"),c=r("./src/Sound.ts"),l=r("./src/utility/evaluator.ts"),d=r("./src/utility/test.ts"),u=r("./src/utility/helper.ts"),T=r("./src/aiconfig.ts"),_=r("./src/damage.ts"),h=r("./src/damagetracker.ts"),p=r("./src/predicates/combat/Predicate_HasAmmo.ts"),S=r("./src/predicates/Functional.ts");t.tree=new s.BehaviorTree({tree:n.BT_Root,blackboard:{target:null,eqsResults:{},damageTracker:new h.DamageTracker,actionStatus:new Map}});const g=(e,t)=>{((e,t)=>{const r=e.Self.Weapons.filter((e=>e.Tags.find((e=>"Weapon.Primary"===e))));if(0===r.length)console.log(`Hash: ${e.Self.Hash}, Name: ${e.Self.Name} AI has no primary weapons. AI will not work properly.`);else{const s=r.filter((e=>!e.Tags.find((e=>"Weapon.Melee"===e)))).filter((e=>e.DamageFalloff>0));if(0===s.length)console.log(`Hash: ${e.Self.Hash}, Name: ${e.Self.Name} AI has no valid optimal range setup. Defaulting optimal range to melee range.`),t.idealEngagementRange=T.CURRENT_AI_CONFIG.closeCombatEnterRange*T.CURRENT_AI_CONFIG.optimalRangeMultiplier,t.optimalEngagementRange=T.CURRENT_AI_CONFIG.closeCombatEnterRange;else{const e=Math.min(...s.map((e=>e.DamageFalloff)));t.idealEngagementRange=e*T.CURRENT_AI_CONFIG.optimalRangeMultiplier,t.optimalEngagementRange=e}}})(e,t);const r=e.Self.Weapons.filter((e=>e.Tags.find((e=>"Weapon.Secondary"===e))));t.secondaryWeapon=0!==r.length?r[0]:null;const s=e.Self.Weapons.filter((e=>e.Tags.find((e=>"Weapon.Melee"===e))));t.canMelee=0!==s.length,t.weapons=e.Self.Weapons};function m(e){const r=t.tree.blackboard,s=[e=>1-(e.Health+e.Shield)/(e.HealthMax+e.ShieldMax),e=>1-Math.min(1,(0,o.distanceTo)(r.input.Self,e)/T.CURRENT_AI_CONFIG.sightMaxDistance),e=>Math.min(1,r.damageTracker.getTotalDamageByTime(r.currentTime,10,e.Hash)/2e3),e=>.2*(r.target&&r.target.Hash===e.Hash?1:0)];return s.map((t=>t(e))).reduce(((e,t)=>e+t))/s.length}function v(){const e=t.tree.blackboard;e.target=null,e.canSeeTarget=!1,e.isTargetInWeaponLOS=!1,void 0!==e.targetLostSightTime&&delete e.targetLostSightTime,void 0!==e.targetLastKnownLocation&&delete e.targetLastKnownLocation,void 0!==e.targetPredictedLocation&&delete e.targetPredictedLocation}t.onBegin=e=>{const r=t.tree.blackboard;g(e,r),r.currentTime=0,r.currentMovementMode="Walk",r.isBattleZonePresent=a.AI.IsBattleZonePresent(),console.log(`${e.Self.Hash}: ${e.Self.Name} AI Started`)},t.onTick=e=>{const r=t.tree.blackboard;0!==e.Errors.length&&e.Errors.forEach((e=>console.log(`${e.Severity}: ${e.Command}: ${e.Message}`))),function(e){const r=t.tree.blackboard;r.weapons.length!==e.Self.Weapons.length&&g(e,r),r.input=e,r.currentTime+=e.DeltaTime;const s=function(){const e=t.tree.blackboard,r=e.input.Perception.Sight,s=(e.input.Perception.Damage,e.target?r.findIndex((t=>t.Hash===e.target.Hash)):-1),a=r.filter((e=>function(e,r=!1){const s=t.tree.blackboard;return[()=>e.Health>0,()=>s.input.Self.FactionId!==e.FactionId,()=>(0,o.distanceTo)(s.input.Self,e)<=T.CURRENT_AI_CONFIG.sightMaxDistance].map((e=>e())).reduce(((e,t)=>e&&t))}(e)));if(0===a.length)return-1===s?e.target:null;const n=a.map(m);return a[n.indexOf(Math.max(...n))]}();null===s?v():r.target=s,function(){const e=t.tree.blackboard,r=e.input.Perception.Sight;if(void 0!==e.damageInstigatorHash&&-1!==r.findIndex((t=>t.Hash===e.damageInstigatorHash&&t.Health<=0))&&function(){const e=t.tree.blackboard;void 0!==e.damageStimulusTime&&delete e.damageStimulusTime,void 0!==e.damageInstigatorHash&&delete e.damageInstigatorHash,void 0!==e.damageStimulusDirection&&delete e.damageStimulusDirection,void 0!==e.damageStimulusFocalPoint&&delete e.damageStimulusFocalPoint}(),!e.target)return;if(0===r.length)e.canSeeTarget&&(e.targetLostSightTime=e.currentTime),e.canSeeTarget=!1;else{const t=-1!==r.findIndex((t=>t.Hash===e.target.Hash));e.canSeeTarget&&!t&&(e.targetLostSightTime=e.currentTime),e.canSeeTarget=t,e.canSeeTarget&&(e.targetLastKnownLocation=e.target.Location,e.targetPredictedLocation=e.target.Location,e.targetLastKnownVelocity=e.target.Velocity,e.lastTargetUpdateTime=e.currentTime)}if(void 0===e.targetLostSightTime)return;if(void 0===e.targetLastKnownLocation)return;if(void 0===e.targetLastKnownVelocity)return;const s=e.currentTime-e.lastTargetUpdateTime;s>=T.CURRENT_AI_CONFIG.predictionUpdateInterval&&(e.targetPredictedLocation=(0,o.add)(e.targetPredictedLocation,(0,o.multiply)(e.targetLastKnownVelocity,s)),e.lastTargetUpdateTime=e.currentTime)}(),function(){const e=t.tree.blackboard,r=e.input.Perception.Damage;if(0===r.length)return;const s=r.filter((e=>!e.IsFriendly));if(0===s.length)return;const a=s.length-1;e.damageStimulusTime=e.currentTime,e.damageInstigatorHash=s[a].InstigatorHash,e.damageStimulusDirection=s[a].Direction,e.damageStimulusFocalPoint=(0,o.add)(e.input.Self.Location,(0,o.multiply)(e.damageStimulusDirection,1e4)),e.lastHitLocation=e.input.Self.Location,e.isLastDamageFromTarget=e.target&&e.target.Hash===s[a].InstigatorHash,e.damageTracker.addDamage(...s.map((t=>new _.Damage(e.currentTime,t))))}(),function(){const e=t.tree.blackboard,r=e.input.Perception.Sound,s=e.input.Self.Location;if(0===r.length)return;const o=r.filter((e=>!e.IsFriendly)),n=o.filter((e=>"Taunt"===e.Type&&a.AI.IsNavigable(e.Location))),i=o.filter((e=>"Weapon"===e.Type&&a.AI.IsNavigable(e.Location))),T=new l.Evaluator(i).addTest(new d.Test((e=>(0,u.scoreByDistance)(s,e.Location)))).getBestItem(),_=new l.Evaluator(n).addTest(new d.Test((e=>(0,u.scoreByDistance)(s,e.Location)))).getBestItem();void 0!==T&&(e.lastWeaponNoise=new c.Sound(T,e.currentTime)),void 0!==_&&(e.heardNoise=!0,e.noiseLocation=_.Location)}(),function(){const e=t.tree.blackboard;if(0===e.input.Perception.Interactable.length)return void(void 0!==e.desiredPickupLocation&&delete e.desiredPickupLocation);const r=function(){const e=t.tree.blackboard,r=function(){const e=t.tree.blackboard,r=e.input.Self,s=r.Weapons.filter((e=>e.Tags.find((e=>"Weapon.Primary"===e))&&e.Tags.find((e=>"Weapon.Fireable"===e)))),a=s.map((e=>e.CurrentAmmo)).reduce(((e,t)=>e+t),0),n=s.map((e=>e.MaxAmmo)).reduce(((e,t)=>e+t),0),i=e=>1-r.Health/r.HealthMax,c=e=>1-r.Shield/r.ShieldMax,l=e=>1-Math.min(1,(0,o.distanceToVec)(r.Location,e.Location)/5e4),d=[i,e=>c()-1,l],u=[e=>i()-1,c,l],T=[l,e=>1-a/n];let _=[];for(const t of e.input.Perception.Interactable){let e=0;"Pickup.Heal"===t.Tag?e=d.map((e=>e(t))).reduce(((e,t)=>e+t)):"Pickup.Shield"===t.Tag?e=u.map((e=>e(t))).reduce(((e,t)=>e+t)):"Pickup.Ammo"===t.Tag&&(e=T.map((e=>e(t))).reduce(((e,t)=>e+t),0)),_.push(e)}return _}(),s=r.indexOf(Math.max(...r));return r[s]>0?e.input.Perception.Interactable[s]:void 0}();void 0!==r&&a.AI.IsNavigable(r.Location)&&(e.desiredPickupLocation=r.Location)}(),(0,t.updateBlackboardAmmo)(r)}(e),t.tree.step();for(let[t,s]of Object.entries(e.EnvQueryStatus))r.eqsResults[t]=s,2===s.Status&&a.AI.EQS_Complete((0,i.StringToEQSQueryType)(t))},t.updateBlackboardAmmo=e=>{e.hasPrimaryAmmo=(0,S.disjunct)((0,p.Predicate_HasAmmoByTag)("Weapon.Primary","Weapon.Fireable"))(e),e.hasSecondaryAmmo=(0,p.Predicate_HasAmmoByTag)("Weapon.Secondary")(e)},t.clearBlackboardTarget=v},"./src/predicates/Functional.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disjunct=t.conjunct=t.negate=void 0;const r=()=>!0,s=()=>!1,o=(e,t,r=0,s,a)=>r>=t.length?s:t[r](e)!==a()?!a():o(e,t,r+1,s,a);t.negate=e=>t=>!e(t),t.conjunct=(...e)=>t=>o(t,e,0,!0,r),t.disjunct=(...e)=>t=>o(t,e,0,!1,s)},"./src/predicates/Predicate_CanActivateAction.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_CanActivateUserAction=t.Predicate_CanActivateAction=void 0;const s=r("./src/index.ts"),o=r("./src/aiconfig.ts");t.Predicate_CanActivateAction=e=>t=>!!s.AI.CanActivateAction(e),t.Predicate_CanActivateUserAction=e=>t=>!!o.CURRENT_AI_CONFIG.enableUserAction&&!!s.AI.CanActivateAction(e)},"./src/predicates/Predicate_FocusToDamage.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToDamage=void 0;const s=r("./src/aiconfig.ts");t.Predicate_FocusToDamage=e=>void 0!==e.damageStimulusFocalPoint&&(void 0!==e.damageInstigatorHash&&(null===e.target||!e.canSeeTarget&&(!(e.damageStimulusTime<=e.targetLostSightTime)||!(e.currentTime-e.damageStimulusTime>=s.CURRENT_AI_CONFIG.damageStimulusTimeout)&&e.damageInstigatorHash!==e.target.Hash)))},"./src/predicates/Predicate_FocusToPredictedLocation.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToPredictedLocation=void 0;const s=r("./src/aiconfig.ts");t.Predicate_FocusToPredictedLocation=e=>void 0!==e.targetPredictedLocation&&!(e.currentTime-e.targetLostSightTime>=s.CURRENT_AI_CONFIG.predictionTimeout)},"./src/predicates/Predicate_FocusToWeaponNoise.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_FocusToWeaponNoise=void 0;const s=r("./src/aiconfig.ts");t.Predicate_FocusToWeaponNoise=e=>!!e.lastWeaponNoise&&!(e.currentTime-e.lastWeaponNoise.time>=s.CURRENT_AI_CONFIG.weaponNoiseStimulusTimeout)},"./src/predicates/Predicate_HasLowShield.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_HasLowShield=void 0;const s=r("./src/aiconfig.ts");t.Predicate_HasLowShield=e=>{const t=e.input.Self;return!(t.ShieldMax<=0)&&t.Shield/t.ShieldMax<=s.CURRENT_AI_CONFIG.lowShieldThreshold}},"./src/predicates/Predicate_HasVeryLowTotalHealth.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_TargetHasVeryLowTotalHealth=t.Predicate_HasVeryLowTotalHealth=void 0;const s=r("./src/aiconfig.ts");t.Predicate_HasVeryLowTotalHealth=e=>{let t=e.input.Self;return(t.Health+t.Shield)/(t.HealthMax+t.ShieldMax)<=s.CURRENT_AI_CONFIG.veryLowTotalHealthThreshold},t.Predicate_TargetHasVeryLowTotalHealth=e=>{const t=e.target;return null!==t&&(t.Health+t.Shield)/(t.HealthMax+t.ShieldMax)<=s.CURRENT_AI_CONFIG.veryLowTotalHealthThreshold}},"./src/predicates/Predicate_InRange.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_TargetInRange=t.Predicate_InRange=void 0;const s=r("./src/helper.ts");t.Predicate_InRange=(e,t,r)=>o=>(0,s.distanceToVec)(e,t)<=r,t.Predicate_TargetInRange=e=>r=>null!==r.target&&!!r.canSeeTarget&&(0,t.Predicate_InRange)(r.input.Self.Location,r.target.Location,e)(r)},"./src/predicates/Predicate_IsInsideBattleZone.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsInsideBattleZone=t.Predicate_IsTargetInsideBattleZone=t.Predicate_IsLocationInsideBattleZone=void 0;const s=r("./src/index.ts"),o=r("./src/utils.ts");t.Predicate_IsLocationInsideBattleZone=e=>t=>{const r=t[e];return!!r&&!!(0,o.IsVector)(r)&&s.AI.IsInsideBattleZone(r)},t.Predicate_IsTargetInsideBattleZone=e=>{if(!e.target)return!1;const t=e.target.Location;return s.AI.IsInsideBattleZone(t)},t.Predicate_IsInsideBattleZone=e=>{const t=e.input.Self.Location;return s.AI.IsInsideBattleZone(t)}},"./src/predicates/Predicate_IsOutnumbered.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsOutnumbered=void 0,t.IsOutnumbered=e=>{const t=e.input.Self.FactionId,r=e.input.Perception.Sight.filter((e=>e.FactionId===t&&e.Health>0)),s=e.input.Perception.Sight.filter((e=>e.FactionId!==t&&e.Health>0));return r.length+1<s.length}},"./src/predicates/Predicate_IsSet.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsSet=void 0,t.Predicate_IsSet=(e,t=!0)=>r=>!!r[e]===t},"./src/predicates/Predicate_IsTeamInAdvantage.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsTeamInAdvantage=void 0,t.Predicate_IsTeamInAdvantage=e=>{const t=e.input.Self.FactionId,r=e.input.Perception.Sight.filter((e=>e.FactionId===t&&e.Health>0)),s=e.input.Perception.Sight.filter((e=>e.FactionId!==t&&e.Health>0));return r.map((e=>(e.Health+e.Shield)/(e.HealthMax+e.ShieldMax)))>s.map((e=>(e.Health+e.Shield)/(e.HealthMax+e.ShieldMax)))}},"./src/predicates/Predicate_IsUsingAction.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_IsUsingAction=void 0,t.Predicate_IsUsingAction=e=>t=>{const r=t.actionStatus.get(e);return void 0!==r&&r}},"./src/predicates/Predicate_TargetHasMoreTotalHealth.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetHasWayMoreTotalHealthRatio=t.TargetHasMoreTotalHealth=void 0,t.TargetHasMoreTotalHealth=e=>{const t=e.input.Self,r=e.target;if(null===r)return!1;const s=(t.Health+t.Shield)/(t.HealthMax+t.ShieldMax);return(r.Health+r.Shield)/(r.HealthMax+r.ShieldMax)>s},t.TargetHasWayMoreTotalHealthRatio=e=>{const t=e.input.Self,r=e.target;if(null===r)return!1;const s=(t.Health+t.Shield)/(t.HealthMax+t.ShieldMax)-(r.Health+r.Shield)/(r.HealthMax+r.ShieldMax);return!(s>=0)&&s+.2<=0}},"./src/predicates/Predicate_UseTaunt.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_UseTaunt=void 0;const s=r("./src/predicates/Predicate_CanActivateAction.ts"),o=r("./src/predicates/Predicate_HasLowShield.ts");t.Predicate_UseTaunt=e=>!(0,o.Predicate_HasLowShield)(e)&&!!(0,s.Predicate_CanActivateAction)("Action.Taunt")(e)},"./src/predicates/combat/Predicate_CloseCombat.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_CloseCombat=void 0;const s=r("./src/aiconfig.ts"),o=r("./src/helper.ts");t.Predicate_CloseCombat=e=>{if(!e.canMelee)return!1;if(!e.canSeeTarget)return!1;if(void 0===e.targetLastKnownLocation)return!1;if(void 0===e.targetLastKnownVelocity)return!1;const t=e.input.Self.Location,r=(0,o.distanceToVec)(t,e.targetLastKnownLocation),a=e.actionStatus.get("Action.MeleeAttack");return void 0!==a&&a?r<=s.CURRENT_AI_CONFIG.closeCombatExitRange:r<=s.CURRENT_AI_CONFIG.closeCombatEnterRange}},"./src/predicates/combat/Predicate_HasAmmo.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_HasAmmoByTag=t.Predicate_HasAmmoByHash=void 0;const r=(e,t,s=0)=>{if(0===e.length)return[];if(s>=t.length)return e;const o=t[s],a=e.filter((e=>e.Tags.find((e=>e===o))));return r(a,t,s+1)};t.Predicate_HasAmmoByHash=e=>t=>{const r=t.input.Self.Weapons.findIndex((t=>t.Hash===e));return-1!==r&&t.input.Self.Weapons[r].CurrentAmmo>0},t.Predicate_HasAmmoByTag=(...e)=>t=>r(t.input.Self.Weapons,e).map((e=>e.CurrentAmmo)).reduce(((e,t)=>e+t),0)>0},"./src/predicates/combat/Predicate_RecentlyLostTarget.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_RecentlyLostTarget=void 0;const s=r("./src/aiconfig.ts");t.Predicate_RecentlyLostTarget=e=>!!e.target&&(!e.canSeeTarget&&(void 0!==e.targetLostSightTime&&e.currentTime-e.targetLostSightTime<=s.CURRENT_AI_CONFIG.sprintOnLostTargetTimeout))},"./src/predicates/combat/Predicate_SprintToEngagement.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_SprintToEngagementByDistance=void 0;const s=r("./src/predicates/Predicate_InRange.ts");t.Predicate_SprintToEngagementByDistance=e=>t=>"Sprint"!==t.currentMovementMode&&!(0,s.Predicate_InRange)(t.input.Self.Location,e,t.optimalEngagementRange)(t)},"./src/predicates/combat/Predicate_UseSpecialAttack.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Predicate_UseSpecialAttack=void 0;const s=r("./src/predicates/Predicate_CanActivateAction.ts"),o=r("./src/helper.ts");t.Predicate_UseSpecialAttack=e=>{if(!e.secondaryWeapon)return!1;if(!e.target)return!1;if(!e.canSeeTarget)return!1;if(!(0,s.Predicate_CanActivateAction)("Action.SpecialAttack")(e))return!1;const t=(0,o.distanceTo)(e.input.Self,e.target);return(0,o.size)(e.target.Velocity)/e.target.MaxSpeed<.5&&t<=e.secondaryWeapon.DamageFalloff}},"./src/tasks/BTT_ClearTarget.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_ClearTarget=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/mech.ts");t.BTT_ClearTarget=new s.Task({run:e=>((0,o.clearBlackboardTarget)(),s.SUCCESS)})},"./src/tasks/BTT_Failure.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Failure=void 0;const s=r("./node_modules/behaviortree/lib/index.js");t.BTT_Failure=new s.Task({run:e=>s.FAILURE})},"./src/tasks/BTT_LookAt.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_LookAt=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts"),a=r("./src/utils.ts");t.BTT_LookAt=e=>new s.Task({start:t=>{const r=t[e];if(r&&(0,a.IsVector)(r))return o.AI.LookAt(r)?s.SUCCESS:s.FAILURE},run:e=>{switch(o.AI.QueryStatus("Action.LookAt")){case 0:return s.RUNNING;case 2:default:return s.FAILURE;case 1:return s.SUCCESS}}})},"./src/tasks/BTT_MeleeAttack.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_MeleeAttack=void 0;const s=r("./src/index.ts"),o=r("./node_modules/behaviortree/lib/index.js");t.BTT_MeleeAttack=e=>new o.Task({run:t=>(s.AI.WeaponTrigger(e),t.actionStatus.set("Action.MeleeAttack",!0),o.RUNNING),end:t=>{s.AI.WeaponRelease(e),t.actionStatus.set("Action.MeleeAttack",!1)},abort:t=>{s.AI.WeaponRelease(e),t.actionStatus.set("Action.MeleeAttack",!1)}})},"./src/tasks/BTT_Running.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Running=void 0;const s=r("./node_modules/behaviortree/lib/index.js");t.BTT_Running=new s.Task({run:e=>s.RUNNING})},"./src/tasks/BTT_SetValue.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SetValue=void 0;const s=r("./node_modules/behaviortree/lib/index.js");t.BTT_SetValue=e=>new s.Task({run:t=>(e(t),s.SUCCESS)})},"./src/tasks/BTT_SpecialAttack.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SpecialAttack=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts"),a=r("./src/utils.ts");t.BTT_SpecialAttack=e=>new s.Task({start:t=>{const r=t[e];if(!r||!(0,a.IsVector)(r))return s.FAILURE;if(void 0===t.secondaryWeapon||null===t.secondaryWeapon)return s.FAILURE;const n=o.AI.TrySpecialAttack(r);return n&&t.actionStatus.set("Action.SpecialAttack",!0),n?s.SUCCESS:s.FAILURE},run:e=>{switch(o.AI.QueryStatus("Action.SpecialAttack")){case 0:return s.RUNNING;case 2:default:return s.FAILURE;case 1:return s.SUCCESS}},end:e=>{e.actionStatus.set("Action.SpecialAttack",!1)},abort:e=>{e.actionStatus.set("Action.SpecialAttack",!1)}})},"./src/tasks/BTT_Success.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Success=void 0;const s=r("./node_modules/behaviortree/lib/index.js");t.BTT_Success=new s.Task({run:e=>s.SUCCESS})},"./src/tasks/BTT_Taunt.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Taunt=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_Taunt=new s.Task({start:e=>o.AI.Taunt()?s.SUCCESS:s.FAILURE,run:e=>{switch(o.AI.QueryStatus("Action.Taunt")){case 0:return s.RUNNING;case 2:default:return s.FAILURE;case 1:return s.SUCCESS}}})},"./src/tasks/BTT_Wait.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Wait=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_Wait=e=>new s.Task({start:t=>o.AI.Wait(e)?s.SUCCESS:s.FAILURE,run:e=>{switch(o.AI.QueryStatus("Action.Wait")){case 0:return s.RUNNING;case 2:default:return s.FAILURE;case 1:return s.SUCCESS}}})},"./src/tasks/environment/BTT_QuerySetArgument.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_QuerySetArgumentFloat=t.BTT_QuerySetArgumentVector=t.BTT_QuerySetArgumentString=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_QuerySetArgumentString=(e,t,r)=>new s.Task({run:a=>{const n=r(a);return o.AI.EQS_SetArgumentString(e,t,n),s.SUCCESS}}),t.BTT_QuerySetArgumentVector=(e,t,r)=>new s.Task({run:a=>{const n=r(a);return o.AI.EQS_SetArgumentVector(e,t,n),s.SUCCESS}}),t.BTT_QuerySetArgumentFloat=(e,t,r)=>new s.Task({run:a=>{const n=r(a);return o.AI.EQS_SetArgumentFloat(e,t,n),s.SUCCESS}})},"./src/tasks/environment/BTT_RunEQSQuery.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_RunEQSQuery=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_RunEQSQuery=(e,t)=>new s.Task({start:t=>(t.eqsResults[e]={Status:1,Location:{X:0,Y:0,Z:0}},o.AI.EQS_Query(e)?s.SUCCESS:s.FAILURE),run:r=>{const o=r.eqsResults[e];if(!o)return s.FAILURE;switch(o.Status){case 1:return s.RUNNING;case 3:default:return s.FAILURE;case 2:return r[t]=r.eqsResults[e].Location,s.SUCCESS}}})},"./src/tasks/focus/BTT_SetFocalPoint.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SetFocalPoint=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts"),a=r("./src/utils.ts"),n=r("./src/aiconfig.ts");t.BTT_SetFocalPoint=e=>new s.Task({start:t=>{n.ENABLE_DEBUGGING&&console.log("BTT_SetFocalPoint: Start called.");const r=t[e];return r?(n.ENABLE_DEBUGGING&&console.log("BTT_SetFocalPoint: Focus location: "+JSON.stringify(r)),(0,a.DoesProvideVectorContext)(r)?o.AI.SetFocalPointByLocation(r.getVectorValue())?s.SUCCESS:s.FAILURE:(0,a.IsWarMachine)(r)?o.AI.SetFocalPointByHash(r.Hash)?s.SUCCESS:s.FAILURE:(0,a.IsVector)(r)?o.AI.SetFocalPointByLocation(r)?s.SUCCESS:s.FAILURE:(console.log("BTT_SetFocalPoint: Invalid focal point type."),s.FAILURE)):s.FAILURE},run:e=>s.SUCCESS})},"./src/tasks/movement/BTT_MoveTo.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_MoveTo=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts"),a=r("./src/utils.ts"),n=r("./src/aiconfig.ts");t.BTT_MoveTo=(e,t=!1,r=600,i=20)=>new s.Task({start:t=>{n.ENABLE_DEBUGGING&&console.log("BTT_MoveTo: Move To called.");const i=t[e];return i&&(0,a.IsVector)(i)?(n.ENABLE_DEBUGGING&&console.log("BTT_MoveTo: Move To Location: "+JSON.stringify(i)),o.AI.MoveToVector(i,r)?s.SUCCESS:s.FAILURE):s.FAILURE},run:n=>{if(t){const t=n[e];if(!t||!(0,a.IsVector)(t))return s.FAILURE;if(!o.AI.MoveToVector(t,r))return s.FAILURE}switch(o.AI.QueryMovementResult()){case 0:return s.RUNNING;case 1:return s.SUCCESS;default:return s.FAILURE}}})},"./src/tasks/movement/BTT_SetMovementMode.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_SetMovementMode=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_SetMovementMode=e=>new s.Task({start:t=>{const r=o.AI.SetMovementMode(e);return r&&(t.currentMovementMode=e),r?s.SUCCESS:s.FAILURE},run:e=>s.SUCCESS})},"./src/tasks/movement/BTT_StopMoveTo.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_StopMoveTo=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_StopMoveTo=new s.Task({run:e=>(o.AI.StopMoveTo(),s.SUCCESS)})},"./src/tasks/useraction/BTT_TriggerUserAction.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_TriggerUserAction=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_TriggerUserAction=e=>new s.Task({start:t=>o.AI.TriggerUserAction(e)?s.SUCCESS:s.FAILURE,run:e=>s.SUCCESS})},"./src/tasks/weapon/BTT_Shoot.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BTT_Shoot=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/index.ts");t.BTT_Shoot=e=>new s.Task({start:t=>{const r=t.input.Self.Weapons.findIndex((t=>t.Tags.find((t=>t===e))));return-1===r||t.input.Self.Weapons[r].Tags.find((e=>"Weapon.Melee"===e))?s.FAILURE:s.SUCCESS},run:t=>{const r=t.input.Self.Weapons.findIndex((t=>t.Tags.find((t=>t===e))));if(-1===r)return s.FAILURE;const a=t.input.Self.Weapons[r].CurrentAmmo>0;return a?o.AI.WeaponTrigger(e,t.targetLastKnownLocation):o.AI.WeaponRelease(e),a?s.RUNNING:s.FAILURE},end:t=>{o.AI.WeaponRelease(e)},abort:t=>{o.AI.WeaponRelease(e)}})},"./src/trees/BT_Camp.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Camp=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/branches/ParallelBackground.ts"),a=r("./src/decorators/IsSet.ts"),n=r("./src/trees/BT_GetCover.ts"),i=r("./src/trees/BT_LookAround.ts"),c=r("./src/trees/BT_SetFocal.ts"),l=r("./src/tasks/BTT_SetValue.ts"),d=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),u=r("./src/decorators/Predicate.ts"),T=r("./src/trees/movement/BT_MovementMode.ts");t.BT_Camp=new s.Sequence({nodes:[new o.ParallelBackground({nodes:[new s.Sequence({nodes:[new s.Selector({nodes:[(0,a.IsSet)(n.BT_GetCover,"coverLocation",!1),(0,u.Predicate)((0,T.BT_SprintMoveTo)("coverLocation"),(0,d.Predicate_IsLocationInsideBattleZone)("coverLocation"),!0,s.ObserverAborts.Self),n.BT_GetCover]}),(0,l.BTT_SetValue)((e=>e.coverLocation=void 0))]}),c.BT_SetFocal]}),i.BT_LookAround]})},"./src/trees/BT_CloseStrafe.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CloseStrafe=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/trees/movement/BT_MovementMode.ts");t.BT_CloseStrafe=new s.Sequence({nodes:[(0,o.BTT_QuerySetArgumentString)("closeStrafe","TargetHash",(e=>e.target.Hash)),(0,o.BTT_QuerySetArgumentVector)("closeStrafe","TargetLastKnownLocation",(e=>e.targetLastKnownLocation)),(0,o.BTT_QuerySetArgumentFloat)("closeStrafe","GridSize",(e=>4e3)),(0,a.BTT_RunEQSQuery)("closeStrafe","closeStrafeLocation"),(0,i.BT_MoveByDistanceToTarget)("closeStrafeLocation"),(0,n.BTT_SetValue)((e=>e.closeStrafeLocation=void 0))]})},"./src/trees/BT_Flee.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Flee=void 0;const s=r("./src/decorators/Predicate.ts"),o=r("./node_modules/behaviortree/lib/index.js"),a=r("./src/trees/BT_GetPickup.ts"),n=r("./src/trees/battlezone/BT_MoveToBattleZone.ts"),i=r("./src/trees/BT_GetCover.ts"),c=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),l=r("./src/predicates/Predicate_IsSet.ts");t.BT_Flee=new o.Selector({nodes:[(0,s.Predicate)(n.BT_MoveToBattleZone,c.Predicate_IsInsideBattleZone,!1,o.ObserverAborts.LowerPriority),(0,s.Predicate)(a.BT_GetPickup,(0,l.Predicate_IsSet)("desiredPickupLocation"),!0,o.ObserverAborts.Both),i.BT_GetCover]})},"./src/trees/BT_GetCover.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_GetCover=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/trees/movement/BT_MovementMode.ts");t.BT_GetCover=new s.Sequence({nodes:[(0,o.BTT_QuerySetArgumentVector)("cover","TargetLastKnownLocation",(e=>void 0!==e.targetLastKnownLocation?e.targetLastKnownLocation:e.input.Self.Location)),(0,o.BTT_QuerySetArgumentVector)("cover","LastHitLocation",(e=>void 0!==e.lastHitLocation?e.lastHitLocation:e.input.Self.Location)),(0,o.BTT_QuerySetArgumentFloat)("cover","GridSize",(e=>2e4)),(0,a.BTT_RunEQSQuery)("cover","coverLocation"),(0,i.BT_SprintMoveTo)("coverLocation"),(0,n.BTT_SetValue)((e=>e.coverLocation=void 0))]})},"./src/trees/BT_GetPickup.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_GetPickup=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/branches/ParallelBackground.ts"),a=r("./src/tasks/BTT_SetValue.ts"),n=r("./src/trees/BT_SetFocal.ts"),i=r("./src/decorators/Predicate.ts"),c=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),l=r("./src/trees/movement/BT_MovementMode.ts");t.BT_GetPickup=new o.ParallelBackground({nodes:[new s.Sequence({nodes:[new s.Selector({nodes:[(0,i.Predicate)((0,l.BT_SprintMoveTo)("desiredPickupLocation",!0),(0,c.Predicate_IsLocationInsideBattleZone)("desiredPickupLocation"),!0,s.ObserverAborts.Self)]}),(0,a.BTT_SetValue)((e=>e.desiredPickupLocation=void 0))]}),n.BT_SetFocal]})},"./src/trees/BT_InvestigateNoise.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_InvestigateNoise=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/BTT_SetValue.ts"),a=r("./src/tasks/focus/BTT_SetFocalPoint.ts"),n=r("./src/trees/BT_SearchHiddenLocation.ts"),i=r("./src/branches/ParallelBackground.ts"),c=r("./src/trees/BT_SetFocal.ts"),l=r("./src/decorators/Predicate.ts"),d=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),u=r("./src/trees/movement/BT_MovementMode.ts");t.BT_InvestigateNoise=new i.ParallelBackground({nodes:[new s.Sequence({nodes:[(0,a.BTT_SetFocalPoint)("noiseLocation"),(0,l.Predicate)((0,u.BT_DefaultMoveTo)("noiseLocation"),(0,d.Predicate_IsLocationInsideBattleZone)("noiseLocation"),!0,s.ObserverAborts.Self),(0,n.BT_SearchHiddenLocation)("noiseLocation"),(0,o.BTT_SetValue)((e=>e.noiseLocation=void 0)),(0,o.BTT_SetValue)((e=>e.heardNoise=!1))]}),c.BT_SetFocal]})},"./src/trees/BT_LookAround.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_LookAround=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/helper.ts"),a=r("./src/tasks/BTT_LookAt.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/tasks/BTT_Wait.ts");t.BT_LookAround=new s.Sequence({nodes:[(0,n.BTT_SetValue)((e=>e.lookAtLocation=(0,o.add)(e.input.Self.Location,(0,o.multiply)((0,o.rotateZ)((0,o.getForwardVector)(e.input.Self.Rotation),90),1e3)))),(0,a.BTT_LookAt)("lookAtLocation"),(0,i.BTT_Wait)(1),(0,n.BTT_SetValue)((e=>e.lookAtLocation=(0,o.add)(e.input.Self.Location,(0,o.multiply)((0,o.rotateZ)((0,o.getForwardVector)(e.input.Self.Rotation),90),1e3)))),(0,a.BTT_LookAt)("lookAtLocation"),(0,i.BTT_Wait)(1),(0,n.BTT_SetValue)((e=>e.lookAtLocation=void 0))]})},"./src/trees/BT_Patrol.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Patrol=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),a=r("./src/tasks/BTT_SetValue.ts"),n=r("./src/tasks/focus/BTT_SetFocalPoint.ts"),i=r("./src/tasks/environment/BTT_QuerySetArgument.ts"),c=r("./src/branches/ParallelBackground.ts"),l=r("./src/trees/BT_SetFocal.ts"),d=r("./src/trees/movement/BT_MovementMode.ts");t.BT_Patrol=new c.ParallelBackground({nodes:[new s.Sequence({nodes:[(0,i.BTT_QuerySetArgumentVector)("patrol","Origin",(e=>e.input.Self.Location)),(0,i.BTT_QuerySetArgumentFloat)("patrol","GridSize",(e=>3e4)),(0,o.BTT_RunEQSQuery)("patrol","patrolLocation"),(0,n.BTT_SetFocalPoint)("patrolLocation"),(0,d.BT_DefaultMoveTo)("patrolLocation"),(0,a.BTT_SetValue)((e=>e.patrolLocation=void 0))]}),l.BT_SetFocal]})},"./src/trees/BT_ReceivedDamage.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_ReceivedDamage=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/helper.ts"),a=r("./src/tasks/BTT_LookAt.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/tasks/movement/BTT_StopMoveTo.ts"),c=r("./src/trees/BT_SearchHiddenLocation.ts"),l=r("./src/branches/ParallelBackground.ts"),d=r("./src/trees/BT_SetFocal.ts");t.BT_ReceivedDamage=new s.Sequence({nodes:[i.BTT_StopMoveTo,(0,a.BTT_LookAt)("damageStimulusFocalPoint"),new l.ParallelBackground({nodes:[new s.Sequence({nodes:[(0,n.BTT_SetValue)((e=>e.damageHiddenLocation=(0,o.add)(e.input.Self.Location,(0,o.multiply)(e.damageStimulusDirection,1e4)))),(0,c.BT_SearchHiddenLocation)("damageHiddenLocation"),(0,n.BTT_SetValue)((e=>e.damageHiddenLocation=void 0)),(0,n.BTT_SetValue)((e=>e.damageStimulusFocalPoint=void 0))]}),d.BT_SetFocal]})]})},"./src/trees/BT_Root.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Root=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/decorators/IsSet.ts"),a=r("./src/decorators/Predicate.ts"),n=r("./src/predicates/Predicate_HasLowShield.ts"),i=r("./src/tasks/BTT_Taunt.ts"),c=r("./src/tasks/BTT_Wait.ts"),l=r("./src/trees/BT_Camp.ts"),d=r("./src/trees/combat/BT_HasTarget.ts"),u=r("./src/trees/BT_GetPickup.ts"),T=r("./src/trees/BT_InvestigateNoise.ts"),_=r("./src/trees/BT_Patrol.ts"),h=r("./src/trees/BT_ReceivedDamage.ts"),p=r("./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts"),S=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),g=r("./src/trees/useraction/BT_UserAction.ts"),m=r("./src/predicates/Predicate_UseTaunt.ts"),v=r("./src/predicates/Predicate_IsSet.ts"),B=r("./src/predicates/Functional.ts"),b=r("./src/trees/BT_Flee.ts"),P=r("./src/predicates/combat/Predicate_UseSpecialAttack.ts");t.BT_Root=new s.Selector({nodes:[(0,a.Predicate)(new s.Selector({nodes:[(0,o.IsSet)(d.BT_HasTarget,"target",!0,s.ObserverAborts.Both),(0,g.BT_Repair)(s.ObserverAborts.LowerPriority),(0,a.Predicate)(p.BT_ParallelMoveToBattleZone,S.Predicate_IsInsideBattleZone,!1,s.ObserverAborts.LowerPriority),(0,o.IsSet)(u.BT_GetPickup,"desiredPickupLocation",!0,s.ObserverAborts.Both),(0,a.Predicate)(l.BT_Camp,n.Predicate_HasLowShield,!0,s.ObserverAborts.LowerPriority),(0,a.Predicate)(i.BTT_Taunt,m.Predicate_UseTaunt),(0,o.IsSet)(h.BT_ReceivedDamage,"damageStimulusFocalPoint",!0,s.ObserverAborts.Both),(0,o.IsSet)(T.BT_InvestigateNoise,"heardNoise",!0,s.ObserverAborts.LowerPriority),_.BT_Patrol]}),(0,B.disjunct)((0,v.Predicate_IsSet)("hasPrimaryAmmo"),(0,v.Predicate_IsSet)("canMelee"),(0,B.conjunct)(P.Predicate_UseSpecialAttack,(0,v.Predicate_IsSet)("hasSecondaryAmmo"))),!0,s.ObserverAborts.Both),b.BT_Flee,(0,c.BTT_Wait)(1)]})},"./src/trees/BT_SearchHiddenLocation.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SearchHiddenLocation=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/tasks/focus/BTT_SetFocalPoint.ts"),c=r("./src/trees/movement/BT_MovementMode.ts");t.BT_SearchHiddenLocation=e=>new s.Sequence({nodes:[(0,o.BTT_QuerySetArgumentVector)("hidden","TargetPredictedLocation",(t=>t[e])),(0,a.BTT_RunEQSQuery)("hidden","hiddenLocation"),(0,i.BTT_SetFocalPoint)("hiddenLocation"),(0,c.BT_DefaultMoveTo)("hiddenLocation"),(0,n.BTT_SetValue)((e=>e.hiddenLocation=void 0))]})},"./src/trees/BT_SearchTarget.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SearchTarget=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/branches/ParallelBackground.ts"),a=r("./src/decorators/IsSet.ts"),n=r("./src/tasks/BTT_ClearTarget.ts"),i=r("./src/trees/BT_SetFocal.ts"),c=r("./src/trees/BT_SearchHiddenLocation.ts"),l=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),d=r("./src/decorators/Predicate.ts"),u=r("./src/trees/movement/BT_MovementMode.ts"),T=r("./src/predicates/combat/Predicate_RecentlyLostTarget.ts");t.BT_SearchTarget=new s.Sequence({nodes:[new o.ParallelBackground({nodes:[new s.Sequence({nodes:[(0,d.Predicate)(new s.Selector({nodes:[(0,d.Predicate)((0,u.BT_SprintMoveTo)("targetLastKnownLocation"),T.Predicate_RecentlyLostTarget),(0,u.BT_DefaultMoveTo)("targetLastKnownLocation")]}),(0,l.Predicate_IsLocationInsideBattleZone)("targetLastKnownLocation"),!0,s.ObserverAborts.Self),(0,a.IsSet)((0,c.BT_SearchHiddenLocation)("targetPredictedLocation"),"targetPredictedLocation")]}),i.BT_SetFocal]}),n.BTT_ClearTarget]})},"./src/trees/BT_SetFocal.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_SetFocal=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/decorators/IsSet.ts"),a=r("./src/decorators/Predicate.ts"),n=r("./src/tasks/BTT_Success.ts"),i=r("./src/tasks/focus/BTT_SetFocalPoint.ts"),c=r("./src/predicates/Predicate_FocusToDamage.ts"),l=r("./src/predicates/Predicate_FocusToPredictedLocation.ts"),d=r("./src/predicates/Predicate_FocusToWeaponNoise.ts"),u=r("./src/tasks/BTT_SetValue.ts");t.BT_SetFocal=new s.Selector({nodes:[(0,o.IsSet)((0,i.BTT_SetFocalPoint)("target"),"canSeeTarget"),(0,a.Predicate)((0,i.BTT_SetFocalPoint)("damageStimulusFocalPoint"),c.Predicate_FocusToDamage),(0,a.Predicate)((0,i.BTT_SetFocalPoint)("targetPredictedLocation"),l.Predicate_FocusToPredictedLocation),(0,o.IsSet)((0,i.BTT_SetFocalPoint)("targetLastKnownLocation"),"targetLastKnownLocation"),(0,a.Predicate)(new s.Sequence({nodes:[(0,i.BTT_SetFocalPoint)("lastWeaponNoise"),(0,u.BTT_SetValue)((e=>e.lastWeaponNoise=void 0))]}),d.Predicate_FocusToWeaponNoise),n.BTT_Success]})},"./src/trees/BT_Strafe.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Strafe=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_QuerySetArgument.ts"),a=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),n=r("./src/tasks/BTT_SetValue.ts"),i=r("./src/trees/movement/BT_MovementMode.ts");t.BT_Strafe=new s.Sequence({nodes:[(0,o.BTT_QuerySetArgumentString)("strafe","TargetHash",(e=>e.target.Hash)),(0,o.BTT_QuerySetArgumentFloat)("strafe","GridSize",(e=>Math.max(2e4,e.idealEngagementRange))),(0,o.BTT_QuerySetArgumentFloat)("strafe","MinDistanceToSelf",(e=>3e3)),(0,o.BTT_QuerySetArgumentFloat)("strafe","MinDistanceToTarget",(e=>0)),(0,o.BTT_QuerySetArgumentFloat)("strafe","MaxDistanceToTarget",(e=>e.idealEngagementRange)),(0,a.BTT_RunEQSQuery)("strafe","strafeLocation"),(0,i.BT_MoveByDistanceToTarget)("strafeLocation"),(0,n.BTT_SetValue)((e=>e.strafeLocation=void 0))]})},"./src/trees/attack/BT_PrimaryAttack.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_PrimaryAttack=void 0;const s=r("./src/decorators/Predicate.ts"),o=r("./src/predicates/combat/Predicate_CloseCombat.ts"),a=r("./src/predicates/combat/Predicate_HasAmmo.ts"),n=r("./src/tasks/BTT_MeleeAttack.ts"),i=r("./src/tasks/weapon/BTT_Shoot.ts"),c=r("./node_modules/behaviortree/lib/index.js"),l=r("./src/trees/helper/BT_Helper.ts"),d=r("./src/tasks/BTT_Running.ts");t.BT_PrimaryAttack=new c.Selector({nodes:[(0,s.Predicate)((0,n.BTT_MeleeAttack)("Weapon.Melee"),o.Predicate_CloseCombat,!0,c.ObserverAborts.Both),(0,s.Predicate)(new c.ParallelSelector({nodes:[(0,l.ForceSuccess)((0,i.BTT_Shoot)("Weapon.Primary.LeftArm")),(0,l.ForceSuccess)((0,i.BTT_Shoot)("Weapon.Primary.RightArm"))]}),(0,a.Predicate_HasAmmoByTag)("Weapon.Primary","Weapon.Fireable"),!0,c.ObserverAborts.Both),d.BTT_Running]})},"./src/trees/attack/BT_SecondaryAttack.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_FireRocketPod=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/helper.ts"),a=r("./src/tasks/BTT_SetValue.ts"),n=r("./src/aiconfig.ts"),i=r("./src/tasks/BTT_SpecialAttack.ts");t.BT_FireRocketPod=new s.Sequence({nodes:[(0,a.BTT_SetValue)((e=>{const t=(0,o.distanceToVec)(e.input.Self.Location,e.target.Location)/Math.max(1,e.secondaryWeapon.ProjectileSpeed),r=(0,o.add)(e.targetLastKnownLocation,(0,o.multiply)(e.targetLastKnownVelocity,n.ROCKET_POD_ACTIVATION_TIME+t));e.arcLaunchLocation=r})),(0,i.BTT_SpecialAttack)("arcLaunchLocation")]})},"./src/trees/battlezone/BT_MoveToBattleZone.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_MoveToBattleZone=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/environment/BTT_RunEQSQuery.ts"),a=r("./src/tasks/BTT_SetValue.ts"),n=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),i=r("./src/decorators/Predicate.ts"),c=r("./src/trees/movement/BT_MovementMode.ts");t.BT_MoveToBattleZone=new s.Sequence({nodes:[(0,o.BTT_RunEQSQuery)("battleZone","battleZoneLocation"),(0,i.Predicate)((0,c.BT_SprintMoveTo)("battleZoneLocation"),(0,n.Predicate_IsLocationInsideBattleZone)("battleZoneLocation"),!0,s.ObserverAborts.Self),(0,a.BTT_SetValue)((e=>e.battleZoneLocation=void 0))]})},"./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_ParallelMoveToBattleZone=void 0;const s=r("./src/branches/ParallelBackground.ts"),o=r("./src/trees/BT_SetFocal.ts"),a=r("./src/trees/battlezone/BT_MoveToBattleZone.ts");t.BT_ParallelMoveToBattleZone=new s.ParallelBackground({nodes:[a.BT_MoveToBattleZone,o.BT_SetFocal]})},"./src/trees/combat/BT_Combat.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_Combat=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/branches/ParallelBackground.ts"),a=r("./src/decorators/Predicate.ts"),n=r("./src/tasks/focus/BTT_SetFocalPoint.ts"),i=r("./src/trees/helper/BT_Helper.ts"),c=r("./src/trees/useraction/BT_UserAction.ts"),l=r("./src/trees/combat/BT_CombatMovement.ts"),d=r("./src/predicates/Functional.ts"),u=r("./src/predicates/combat/Predicate_UseSpecialAttack.ts"),T=r("./src/trees/attack/BT_PrimaryAttack.ts"),_=r("./src/trees/attack/BT_SecondaryAttack.ts"),h=r("./src/predicates/Predicate_IsSet.ts");t.BT_Combat=new s.Selector({nodes:[(0,a.Predicate)(_.BT_FireRocketPod,(0,d.conjunct)(u.Predicate_UseSpecialAttack,(0,h.Predicate_IsSet)("hasSecondaryAmmo")),!0,s.ObserverAborts.LowerPriority),new o.ParallelBackground({nodes:[T.BT_PrimaryAttack,(0,n.BTT_SetFocalPoint)("target"),(0,i.ForceSuccess)(c.BT_UserAction),(0,i.ForceSuccess)(l.BT_CombatMovement)]})]})},"./src/trees/combat/BT_CombatMovement.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CombatMovement=t.BT_MeleeMovement=void 0;const s=r("./src/decorators/Predicate.ts"),o=r("./node_modules/behaviortree/lib/index.js"),a=r("./src/trees/battlezone/BT_MoveToBattleZone.ts"),n=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),i=r("./src/predicates/Predicate_IsSet.ts"),c=r("./src/trees/BT_GetPickup.ts"),l=r("./src/trees/BT_GetCover.ts"),d=r("./src/predicates/Functional.ts"),u=r("./src/predicates/Predicate_HasLowShield.ts"),T=r("./src/predicates/Predicate_HasVeryLowTotalHealth.ts"),_=r("./src/trees/BT_CloseStrafe.ts"),h=r("./src/trees/movement/BT_MovementMode.ts"),p=r("./src/trees/BT_Strafe.ts"),S=r("./src/predicates/Predicate_IsOutnumbered.ts"),g=r("./src/predicates/Predicate_TargetHasMoreTotalHealth.ts"),m=r("./src/predicates/Predicate_InRange.ts"),v=r("./src/aiconfig.ts"),B=r("./src/predicates/Predicate_IsTeamInAdvantage.ts"),b=(0,d.conjunct)((0,i.Predicate_IsSet)("canMelee"),(0,d.negate)(S.IsOutnumbered),(0,d.negate)(g.TargetHasMoreTotalHealth),(0,d.negate)(T.Predicate_HasVeryLowTotalHealth),(0,d.negate)(u.Predicate_HasLowShield),T.Predicate_TargetHasVeryLowTotalHealth,B.Predicate_IsTeamInAdvantage);t.BT_MeleeMovement=new o.Selector({nodes:[(0,s.Predicate)((0,s.Predicate)((0,h.BT_MoveByDistanceToTarget)("targetLastKnownLocation",!0),n.Predicate_IsTargetInsideBattleZone,!0,o.ObserverAborts.Self),(0,m.Predicate_TargetInRange)(v.CURRENT_AI_CONFIG.closeCombatKeepRange),!1,o.ObserverAborts.LowerPriority),_.BT_CloseStrafe]});const P=new o.Selector({nodes:[(0,s.Predicate)(t.BT_MeleeMovement,b,!0,o.ObserverAborts.Self),p.BT_Strafe]});t.BT_CombatMovement=new o.Selector({nodes:[(0,s.Predicate)(a.BT_MoveToBattleZone,n.Predicate_IsInsideBattleZone,!1,o.ObserverAborts.LowerPriority),(0,s.Predicate)(c.BT_GetPickup,(0,i.Predicate_IsSet)("desiredPickupLocation"),!0,o.ObserverAborts.Both),(0,s.Predicate)(l.BT_GetCover,(0,d.disjunct)(u.Predicate_HasLowShield,T.Predicate_HasVeryLowTotalHealth),!0,o.ObserverAborts.LowerPriority),new o.Selector({nodes:[(0,s.Predicate)(P,(0,i.Predicate_IsSet)("hasPrimaryAmmo"),!0,o.ObserverAborts.Both),t.BT_MeleeMovement]})]})},"./src/trees/combat/BT_CurrentTargetVisible.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_CurrentTargetVisible=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/trees/combat/BT_Combat.ts");t.BT_CurrentTargetVisible=new s.Selector({nodes:[o.BT_Combat]})},"./src/trees/combat/BT_HasTarget.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_HasTarget=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/decorators/IsSet.ts"),a=r("./src/decorators/Predicate.ts"),n=r("./src/predicates/Predicate_HasLowShield.ts"),i=r("./src/trees/BT_Camp.ts"),c=r("./src/trees/combat/BT_CurrentTargetVisible.ts"),l=r("./src/trees/BT_GetPickup.ts"),d=r("./src/trees/BT_SearchTarget.ts"),u=r("./src/tasks/BTT_Success.ts"),T=r("./src/trees/battlezone/BT_ParallelMoveToBattleZone.ts"),_=r("./src/predicates/Predicate_IsInsideBattleZone.ts"),h=r("./src/predicates/Predicate_IsUsingAction.ts"),p=r("./src/trees/useraction/BT_UserAction.ts");t.BT_HasTarget=new s.Selector({nodes:[(0,a.Predicate)(c.BT_CurrentTargetVisible,(e=>e.canSeeTarget||(0,h.Predicate_IsUsingAction)("Action.SpecialAttack")(e)),!0,s.ObserverAborts.Both),(0,p.BT_Repair)(s.ObserverAborts.LowerPriority),(0,a.Predicate)(T.BT_ParallelMoveToBattleZone,_.Predicate_IsInsideBattleZone,!1,s.ObserverAborts.LowerPriority),(0,o.IsSet)(l.BT_GetPickup,"desiredPickupLocation",!0,s.ObserverAborts.Both),(0,a.Predicate)(i.BT_Camp,n.Predicate_HasLowShield,!0,s.ObserverAborts.LowerPriority),(0,a.Predicate)(d.BT_SearchTarget,(e=>!e.canSeeTarget)),u.BTT_Success]})},"./src/trees/helper/BT_Helper.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForceFailure=t.ForceSuccess=void 0;const s=r("./src/tasks/BTT_Failure.ts"),o=r("./src/tasks/BTT_Success.ts"),a=r("./node_modules/behaviortree/lib/index.js");t.ForceSuccess=e=>new a.Selector({nodes:[e,o.BTT_Success]}),t.ForceFailure=e=>new a.Sequence({nodes:[e,s.BTT_Failure]})},"./src/trees/movement/BT_MovementMode.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_MoveByDistanceToTarget=t.BT_DefaultMoveTo=t.BT_SprintMoveTo=t.BT_WalkMoveTo=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/tasks/movement/BTT_SetMovementMode.ts"),a=r("./src/trees/helper/BT_Helper.ts"),n=r("./src/tasks/movement/BTT_MoveTo.ts"),i=r("./src/predicates/combat/Predicate_SprintToEngagement.ts"),c=r("./src/decorators/Predicate.ts"),l=r("./src/aiconfig.ts"),d=e=>(t,r=!1)=>new s.Sequence({nodes:[(0,a.ForceSuccess)((0,o.BTT_SetMovementMode)(e)),(0,n.BTT_MoveTo)(t,r),(0,a.ForceSuccess)((0,o.BTT_SetMovementMode)(l.CURRENT_AI_CONFIG.defaultMovementMode))]});t.BT_WalkMoveTo=d("Walk"),t.BT_SprintMoveTo=d("Sprint"),t.BT_DefaultMoveTo=d(l.CURRENT_AI_CONFIG.defaultMovementMode),t.BT_MoveByDistanceToTarget=(e,r=!1)=>new s.Selector({nodes:[(0,c.Predicate)((0,t.BT_SprintMoveTo)(e,r),(e=>e.target&&(0,i.Predicate_SprintToEngagementByDistance)(e.target.Location)(e)),!0,s.ObserverAborts.LowerPriority),(0,t.BT_DefaultMoveTo)(e,r)]})},"./src/trees/useraction/BT_UserAction.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BT_UserAction=t.BT_Repair=t.BT_Overcharge=void 0;const s=r("./node_modules/behaviortree/lib/index.js"),o=r("./src/decorators/Predicate.ts"),a=r("./src/predicates/Predicate_InRange.ts"),n=r("./src/predicates/Predicate_CanActivateAction.ts"),i=r("./src/tasks/useraction/BTT_TriggerUserAction.ts"),c=r("./src/predicates/Predicate_HasVeryLowTotalHealth.ts");t.BT_Overcharge=e=>(0,o.Predicate)((0,i.BTT_TriggerUserAction)("UserAction.Overcharge"),(e=>(0,a.Predicate_TargetInRange)(5e3)(e)&&(0,n.Predicate_CanActivateUserAction)("UserAction.Overcharge")(e)),!0,e),t.BT_Repair=e=>(0,o.Predicate)((0,i.BTT_TriggerUserAction)("UserAction.Repair"),(e=>(0,c.Predicate_HasVeryLowTotalHealth)(e)&&(0,n.Predicate_CanActivateUserAction)("UserAction.Repair")(e)),!0,e),t.BT_UserAction=new s.Selector({nodes:[(0,t.BT_Overcharge)(s.ObserverAborts.None),(0,t.BT_Repair)(s.ObserverAborts.None)]})},"./src/utility/evaluator.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Evaluator=void 0,t.Evaluator=class{constructor(e,t){this.items=void 0!==e?e:[],this.tests=void 0!==t?t:[]}addItem(e){return this.items.push(e),this}addTest(e){return this.tests.push(e),this}getBestItem(){const e=this.run(),t=e.indexOf(Math.max(...e));return-1!==t?this.items[t]:void 0}run(){return this.items.map((e=>this.tests.map((t=>t.getScore(e))).reduce(((e,t)=>e+t))))}}},"./src/utility/helper.ts":(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterByTime=t.scoreByDistance=t.scoreByHealth=void 0;const s=r("./src/helper.ts");t.scoreByHealth=(e,t)=>1-e/t,t.scoreByDistance=(e,t)=>1-Math.min(1,(0,s.distanceToVec)(e,t)/2e5),t.filterByTime=(e,t,r)=>t-e>=r},"./src/utility/test.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Test=void 0,t.Test=class{constructor(e){this.scoreFunc=e}getScore(e){return this.scoreFunc(e)}}},"./src/utils.ts":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoesProvideVectorContext=t.IsWarMachine=t.IsVector=t.StringToEQSQueryType=void 0,t.StringToEQSQueryType=e=>{switch(e){case"away":return"away";case"cover":return"cover";case"hidden":return"hidden";case"patrol":return"patrol";case"strafe":return"strafe";case"closeStrafe":return"closeStrafe";case"battleZone":return"battleZone"}},t.IsVector=e=>"X"in e&&"Y"in e,t.IsWarMachine=e=>"Hash"in e,t.DoesProvideVectorContext=e=>"getVectorValue"in e}},t={};!function r(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}("./src/mech.ts")})();
//# sourceMappingURL=mech.js.map